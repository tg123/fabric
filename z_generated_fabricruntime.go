// Code generated by "go run github.com/tg123/fabric/mkidl"; DO NOT EDIT.
package fabric

import (
	"context"
	"github.com/go-ole/go-ole"
	"golang.org/x/sys/windows"
	"reflect"
	"syscall"
	"time"
	"unsafe"
)

func (c *FabricClient) CreateFabricRuntime() (*ComFabricRuntime, error) {
	var com *ComFabricRuntime
	err := c.createComObject("{cc53af8e-74cd-11df-ac3e-0024811e3892}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricRuntime struct {
	ole.IUnknown
}

type ComFabricRuntimeVtbl struct {
	ole.IUnknownVtbl
	BeginRegisterStatelessServiceFactory uintptr
	EndRegisterStatelessServiceFactory   uintptr
	RegisterStatelessServiceFactory      uintptr
	BeginRegisterStatefulServiceFactory  uintptr
	EndRegisterStatefulServiceFactory    uintptr
	RegisterStatefulServiceFactory       uintptr
	CreateServiceGroupFactoryBuilder     uintptr
	BeginRegisterServiceGroupFactory     uintptr
	EndRegisterServiceGroupFactory       uintptr
	RegisterServiceGroupFactory          uintptr
}

func (v *ComFabricRuntime) VTable() *ComFabricRuntimeVtbl {
	return (*ComFabricRuntimeVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricRuntime) beginRegisterStatelessServiceFactory(
	serviceTypeName string,
	factory *ComFabricStatelessServiceFactory,
	timeoutMilliseconds uint32,
	callback *comIFabricAsyncOperationCallback,
) (context *comIFabricAsyncOperationContext, err error) {
	var p_0 *uint16
	s_1, _ := windows.UTF16PtrFromString(serviceTypeName)
	p_0 = s_1

	var p_4 *comIFabricAsyncOperationContext
	defer func() {
		context = p_4
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().BeginRegisterStatelessServiceFactory,
		6,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(factory)),
		uintptr(timeoutMilliseconds),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_4)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricRuntime) RegisterStatelessServiceFactory(
	serviceTypeName string,
	factory *ComFabricStatelessServiceFactory,
) (err error) {
	var p_0 *uint16
	s_2, _ := windows.UTF16PtrFromString(serviceTypeName)
	p_0 = s_2

	hr, _, err1 := syscall.Syscall(
		v.VTable().RegisterStatelessServiceFactory,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(factory)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricRuntime) beginRegisterStatefulServiceFactory(
	serviceTypeName string,
	factory *ComFabricStatefulServiceFactory,
	timeoutMilliseconds uint32,
	callback *comIFabricAsyncOperationCallback,
) (context *comIFabricAsyncOperationContext, err error) {
	var p_0 *uint16
	s_3, _ := windows.UTF16PtrFromString(serviceTypeName)
	p_0 = s_3

	var p_4 *comIFabricAsyncOperationContext
	defer func() {
		context = p_4
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().BeginRegisterStatefulServiceFactory,
		6,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(factory)),
		uintptr(timeoutMilliseconds),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_4)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricRuntime) RegisterStatefulServiceFactory(
	serviceTypeName string,
	factory *ComFabricStatefulServiceFactory,
) (err error) {
	var p_0 *uint16
	s_4, _ := windows.UTF16PtrFromString(serviceTypeName)
	p_0 = s_4

	hr, _, err1 := syscall.Syscall(
		v.VTable().RegisterStatefulServiceFactory,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(factory)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricRuntime) CreateServiceGroupFactoryBuilder() (builder *ComFabricServiceGroupFactoryBuilder, err error) {
	var p_0 *ComFabricServiceGroupFactoryBuilder
	defer func() {
		builder = p_0
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().CreateServiceGroupFactoryBuilder,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(&p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricRuntime) beginRegisterServiceGroupFactory(
	groupServiceType string,
	factory *ComFabricServiceGroupFactory,
	timeoutMilliseconds uint32,
	callback *comIFabricAsyncOperationCallback,
) (context *comIFabricAsyncOperationContext, err error) {
	var p_0 *uint16
	s_5, _ := windows.UTF16PtrFromString(groupServiceType)
	p_0 = s_5

	var p_4 *comIFabricAsyncOperationContext
	defer func() {
		context = p_4
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().BeginRegisterServiceGroupFactory,
		6,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(factory)),
		uintptr(timeoutMilliseconds),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_4)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricRuntime) RegisterServiceGroupFactory(
	groupServiceType string,
	factory *ComFabricServiceGroupFactory,
) (err error) {
	var p_0 *uint16
	s_6, _ := windows.UTF16PtrFromString(groupServiceType)
	p_0 = s_6

	hr, _, err1 := syscall.Syscall(
		v.VTable().RegisterServiceGroupFactory,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(factory)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricStatelessServiceFactory() (*ComFabricStatelessServiceFactory, error) {
	var com *ComFabricStatelessServiceFactory
	err := c.createComObject("{cc53af8f-74cd-11df-ac3e-0024811e3892}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricStatelessServiceFactory struct {
	ole.IUnknown
}

type ComFabricStatelessServiceFactoryVtbl struct {
	ole.IUnknownVtbl
	CreateInstance uintptr
}

func (v *ComFabricStatelessServiceFactory) VTable() *ComFabricStatelessServiceFactoryVtbl {
	return (*ComFabricStatelessServiceFactoryVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricStatelessServiceFactory) CreateInstance(
	serviceTypeName string,
	serviceName string,
	initializationDataLength uint32,
	initializationData *byte,
	partitionId windows.GUID,
	instanceId int64,
) (serviceInstance *ComFabricStatelessServiceInstance, err error) {
	var p_0 *uint16
	s_7, _ := windows.UTF16PtrFromString(serviceTypeName)
	p_0 = s_7

	var p_1 *uint16
	s_8, _ := windows.UTF16PtrFromString(serviceName)
	p_1 = s_8

	var p_6 *ComFabricStatelessServiceInstance
	defer func() {
		serviceInstance = p_6
	}()
	hr, _, err1 := syscall.Syscall9(
		v.VTable().CreateInstance,
		8,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(p_1)),
		uintptr(initializationDataLength),
		uintptr(unsafe.Pointer(initializationData)),
		uintptr(unsafe.Pointer(&partitionId)),
		uintptr(instanceId),
		uintptr(unsafe.Pointer(&p_6)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricStatelessServiceInstance() (*ComFabricStatelessServiceInstance, error) {
	var com *ComFabricStatelessServiceInstance
	err := c.createComObject("{cc53af90-74cd-11df-ac3e-0024811e3892}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricStatelessServiceInstance struct {
	ole.IUnknown
}

type ComFabricStatelessServiceInstanceVtbl struct {
	ole.IUnknownVtbl
	BeginOpen  uintptr
	EndOpen    uintptr
	BeginClose uintptr
	EndClose   uintptr
	Abort      uintptr
}

func (v *ComFabricStatelessServiceInstance) VTable() *ComFabricStatelessServiceInstanceVtbl {
	return (*ComFabricStatelessServiceInstanceVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricStatelessServiceInstance) beginOpen(
	partition *ComFabricStatelessServicePartition,
	callback *comIFabricAsyncOperationCallback,
) (context *comIFabricAsyncOperationContext, err error) {
	var p_2 *comIFabricAsyncOperationContext
	defer func() {
		context = p_2
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().BeginOpen,
		4,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(partition)),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_2)),
		0,
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStatelessServiceInstance) beginClose(
	callback *comIFabricAsyncOperationCallback,
) (context *comIFabricAsyncOperationContext, err error) {
	var p_1 *comIFabricAsyncOperationContext
	defer func() {
		context = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().BeginClose,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStatelessServiceInstance) endClose(
	context *comIFabricAsyncOperationContext,
) (err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().EndClose,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(context)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStatelessServiceInstance) Abort() (rt interface{}, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().Abort,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (unsafe.Pointer)(unsafe.Pointer(hr))

	rt = fromUnsafePointer(tmp)
	return
}
func (v *ComFabricStatelessServiceInstance) Close(
	ctx context.Context,
) (err error) {
	ch := make(chan error, 1)
	defer close(ch)
	callback := newFabricAsyncOperationCallback(func(sfctx *comIFabricAsyncOperationContext) {

		err := v.endClose(sfctx)

		if err != nil {
			ch <- err
			return
		}
		if err != nil {
			ch <- err
			return
		}
		ch <- nil
	})

	var timeout time.Duration
	{
		deadline, ok := ctx.Deadline()
		if ok {
			timeout = deadline.Sub(time.Now())
		} else {
			timeout = 15 * time.Minute
		}

		_ = timeout
	}
	sfctx, err := v.beginClose(
		callback,
	)

	if err != nil {
		return
	}

	select {
	case err = <-ch:
		return

	case <-ctx.Done():
		sfctx.Cancel()
		err = ctx.Err()
		return
	case <-time.After(timeout):
		sfctx.Cancel()
		err = FabricErrorTimeout
		return
	}

}

func (c *FabricClient) CreateFabricStatelessServicePartition() (*ComFabricStatelessServicePartition, error) {
	var com *ComFabricStatelessServicePartition
	err := c.createComObject("{cc53af91-74cd-11df-ac3e-0024811e3892}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricStatelessServicePartition struct {
	ole.IUnknown
}

type ComFabricStatelessServicePartitionVtbl struct {
	ole.IUnknownVtbl
	GetPartitionInfo uintptr
	ReportLoad       uintptr
	ReportFault      uintptr
}

func (v *ComFabricStatelessServicePartition) VTable() *ComFabricStatelessServicePartitionVtbl {
	return (*ComFabricStatelessServicePartitionVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricStatelessServicePartition) GetPartitionInfo() (bufferedValue *FabricServicePartitionInformation, err error) {
	var p_0 *innerFabricServicePartitionInformation
	defer func() {
		bufferedValue = p_0.toGoStruct()
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().GetPartitionInfo,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(&p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStatelessServicePartition) ReportLoad(
	metricCount uint32,
	metrics *FabricLoadMetric,
) (err error) {
	var p_1 *innerFabricLoadMetric
	p_1 = metrics.toInnerStruct()
	hr, _, err1 := syscall.Syscall(
		v.VTable().ReportLoad,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(metricCount),
		uintptr(unsafe.Pointer(p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStatelessServicePartition) ReportFault(
	faultType FabricFaultType,
) (err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().ReportFault,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(faultType),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricStatelessServicePartition1() (*ComFabricStatelessServicePartition1, error) {
	var com *ComFabricStatelessServicePartition1
	err := c.createComObject("{bf6bb505-7bd0-4371-b6c0-cba319a5e50b}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricStatelessServicePartition1 struct {
	ComFabricStatelessServicePartition
}

type ComFabricStatelessServicePartition1Vtbl struct {
	ComFabricStatelessServicePartitionVtbl
	ReportMoveCost uintptr
}

func (v *ComFabricStatelessServicePartition1) VTable() *ComFabricStatelessServicePartition1Vtbl {
	return (*ComFabricStatelessServicePartition1Vtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricStatelessServicePartition1) ReportMoveCost(
	moveCost FabricMoveCost,
) (err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().ReportMoveCost,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(moveCost),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricStatelessServicePartition2() (*ComFabricStatelessServicePartition2, error) {
	var com *ComFabricStatelessServicePartition2
	err := c.createComObject("{9ff35b6c-9d97-4312-93ad-7f34cbdb4ca4}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricStatelessServicePartition2 struct {
	ComFabricStatelessServicePartition1
}

type ComFabricStatelessServicePartition2Vtbl struct {
	ComFabricStatelessServicePartition1Vtbl
	ReportInstanceHealth  uintptr
	ReportPartitionHealth uintptr
}

func (v *ComFabricStatelessServicePartition2) VTable() *ComFabricStatelessServicePartition2Vtbl {
	return (*ComFabricStatelessServicePartition2Vtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricStatelessServicePartition2) ReportInstanceHealth(
	healthInfo *FabricHealthInformation,
) (err error) {
	var p_0 *innerFabricHealthInformation
	p_0 = healthInfo.toInnerStruct()
	hr, _, err1 := syscall.Syscall(
		v.VTable().ReportInstanceHealth,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStatelessServicePartition2) ReportPartitionHealth(
	healthInfo *FabricHealthInformation,
) (err error) {
	var p_0 *innerFabricHealthInformation
	p_0 = healthInfo.toInnerStruct()
	hr, _, err1 := syscall.Syscall(
		v.VTable().ReportPartitionHealth,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricStatelessServicePartition3() (*ComFabricStatelessServicePartition3, error) {
	var com *ComFabricStatelessServicePartition3
	err := c.createComObject("{f2fa2000-70a7-4ed5-9d3e-0b7deca2433f}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricStatelessServicePartition3 struct {
	ComFabricStatelessServicePartition2
}

type ComFabricStatelessServicePartition3Vtbl struct {
	ComFabricStatelessServicePartition2Vtbl
	ReportInstanceHealth2  uintptr
	ReportPartitionHealth2 uintptr
}

func (v *ComFabricStatelessServicePartition3) VTable() *ComFabricStatelessServicePartition3Vtbl {
	return (*ComFabricStatelessServicePartition3Vtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricStatelessServicePartition3) ReportInstanceHealth2(
	healthInfo *FabricHealthInformation,
	sendOptions *FabricHealthReportSendOptions,
) (err error) {
	var p_0 *innerFabricHealthInformation
	p_0 = healthInfo.toInnerStruct()
	var p_1 *innerFabricHealthReportSendOptions
	p_1 = sendOptions.toInnerStruct()
	hr, _, err1 := syscall.Syscall(
		v.VTable().ReportInstanceHealth2,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStatelessServicePartition3) ReportPartitionHealth2(
	healthInfo *FabricHealthInformation,
	sendOptions *FabricHealthReportSendOptions,
) (err error) {
	var p_0 *innerFabricHealthInformation
	p_0 = healthInfo.toInnerStruct()
	var p_1 *innerFabricHealthReportSendOptions
	p_1 = sendOptions.toInnerStruct()
	hr, _, err1 := syscall.Syscall(
		v.VTable().ReportPartitionHealth2,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricStatefulServiceFactory() (*ComFabricStatefulServiceFactory, error) {
	var com *ComFabricStatefulServiceFactory
	err := c.createComObject("{77ff0c6b-6780-48ec-b4b0-61989327b0f2}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricStatefulServiceFactory struct {
	ole.IUnknown
}

type ComFabricStatefulServiceFactoryVtbl struct {
	ole.IUnknownVtbl
	CreateReplica uintptr
}

func (v *ComFabricStatefulServiceFactory) VTable() *ComFabricStatefulServiceFactoryVtbl {
	return (*ComFabricStatefulServiceFactoryVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricStatefulServiceFactory) CreateReplica(
	serviceTypeName string,
	serviceName string,
	initializationDataLength uint32,
	initializationData *byte,
	partitionId windows.GUID,
	replicaId int64,
) (serviceReplica *ComFabricStatefulServiceReplica, err error) {
	var p_0 *uint16
	s_9, _ := windows.UTF16PtrFromString(serviceTypeName)
	p_0 = s_9

	var p_1 *uint16
	s_10, _ := windows.UTF16PtrFromString(serviceName)
	p_1 = s_10

	var p_6 *ComFabricStatefulServiceReplica
	defer func() {
		serviceReplica = p_6
	}()
	hr, _, err1 := syscall.Syscall9(
		v.VTable().CreateReplica,
		8,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(p_1)),
		uintptr(initializationDataLength),
		uintptr(unsafe.Pointer(initializationData)),
		uintptr(unsafe.Pointer(&partitionId)),
		uintptr(replicaId),
		uintptr(unsafe.Pointer(&p_6)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricStatefulServiceReplica() (*ComFabricStatefulServiceReplica, error) {
	var com *ComFabricStatefulServiceReplica
	err := c.createComObject("{8ae3be0e-505d-4dc1-ad8f-0cb0f9576b8a}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricStatefulServiceReplica struct {
	ole.IUnknown
}

type ComFabricStatefulServiceReplicaVtbl struct {
	ole.IUnknownVtbl
	BeginOpen       uintptr
	EndOpen         uintptr
	BeginChangeRole uintptr
	EndChangeRole   uintptr
	BeginClose      uintptr
	EndClose        uintptr
	Abort           uintptr
}

func (v *ComFabricStatefulServiceReplica) VTable() *ComFabricStatefulServiceReplicaVtbl {
	return (*ComFabricStatefulServiceReplicaVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricStatefulServiceReplica) beginOpen(
	openMode FabricReplicaOpenMode,
	partition *ComFabricStatefulServicePartition,
	callback *comIFabricAsyncOperationCallback,
) (context *comIFabricAsyncOperationContext, err error) {
	var p_3 *comIFabricAsyncOperationContext
	defer func() {
		context = p_3
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().BeginOpen,
		5,
		uintptr(unsafe.Pointer(v)),
		uintptr(openMode),
		uintptr(unsafe.Pointer(partition)),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_3)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStatefulServiceReplica) beginChangeRole(
	newRole FabricReplicaRole,
	callback *comIFabricAsyncOperationCallback,
) (context *comIFabricAsyncOperationContext, err error) {
	var p_2 *comIFabricAsyncOperationContext
	defer func() {
		context = p_2
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().BeginChangeRole,
		4,
		uintptr(unsafe.Pointer(v)),
		uintptr(newRole),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_2)),
		0,
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStatefulServiceReplica) endChangeRole(
	context *comIFabricAsyncOperationContext,
) (serviceAddress *ComFabricStringResult, err error) {
	var p_1 *ComFabricStringResult
	defer func() {
		serviceAddress = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().EndChangeRole,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(context)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStatefulServiceReplica) beginClose(
	callback *comIFabricAsyncOperationCallback,
) (context *comIFabricAsyncOperationContext, err error) {
	var p_1 *comIFabricAsyncOperationContext
	defer func() {
		context = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().BeginClose,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStatefulServiceReplica) endClose(
	context *comIFabricAsyncOperationContext,
) (err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().EndClose,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(context)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStatefulServiceReplica) Abort() (rt interface{}, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().Abort,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (unsafe.Pointer)(unsafe.Pointer(hr))

	rt = fromUnsafePointer(tmp)
	return
}
func (v *ComFabricStatefulServiceReplica) ChangeRole(
	ctx context.Context,
	newRole FabricReplicaRole,
) (result_0 string, err error) {
	ch := make(chan error, 1)
	defer close(ch)
	callback := newFabricAsyncOperationCallback(func(sfctx *comIFabricAsyncOperationContext) {

		rt_1, err := v.endChangeRole(sfctx)

		if err != nil {
			ch <- err
			return
		}
		result_0, err = rt_1.GetString()
		if err != nil {
			ch <- err
			return
		}
		ch <- nil
	})

	var timeout time.Duration
	{
		deadline, ok := ctx.Deadline()
		if ok {
			timeout = deadline.Sub(time.Now())
		} else {
			timeout = 15 * time.Minute
		}

		_ = timeout
	}
	sfctx, err := v.beginChangeRole(
		newRole,
		callback,
	)

	if err != nil {
		return
	}

	select {
	case err = <-ch:
		return

	case <-ctx.Done():
		sfctx.Cancel()
		err = ctx.Err()
		return
	case <-time.After(timeout):
		sfctx.Cancel()
		err = FabricErrorTimeout
		return
	}

}
func (v *ComFabricStatefulServiceReplica) Close(
	ctx context.Context,
) (err error) {
	ch := make(chan error, 1)
	defer close(ch)
	callback := newFabricAsyncOperationCallback(func(sfctx *comIFabricAsyncOperationContext) {

		err := v.endClose(sfctx)

		if err != nil {
			ch <- err
			return
		}
		if err != nil {
			ch <- err
			return
		}
		ch <- nil
	})

	var timeout time.Duration
	{
		deadline, ok := ctx.Deadline()
		if ok {
			timeout = deadline.Sub(time.Now())
		} else {
			timeout = 15 * time.Minute
		}

		_ = timeout
	}
	sfctx, err := v.beginClose(
		callback,
	)

	if err != nil {
		return
	}

	select {
	case err = <-ch:
		return

	case <-ctx.Done():
		sfctx.Cancel()
		err = ctx.Err()
		return
	case <-time.After(timeout):
		sfctx.Cancel()
		err = FabricErrorTimeout
		return
	}

}

func (c *FabricClient) CreateFabricStatefulServicePartition() (*ComFabricStatefulServicePartition, error) {
	var com *ComFabricStatefulServicePartition
	err := c.createComObject("{5beccc37-8655-4f20-bd43-f50691d7cd16}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricStatefulServicePartition struct {
	ole.IUnknown
}

type ComFabricStatefulServicePartitionVtbl struct {
	ole.IUnknownVtbl
	GetPartitionInfo uintptr
	GetReadStatus    uintptr
	GetWriteStatus   uintptr
	CreateReplicator uintptr
	ReportLoad       uintptr
	ReportFault      uintptr
}

func (v *ComFabricStatefulServicePartition) VTable() *ComFabricStatefulServicePartitionVtbl {
	return (*ComFabricStatefulServicePartitionVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricStatefulServicePartition) GetPartitionInfo() (bufferedValue *FabricServicePartitionInformation, err error) {
	var p_0 *innerFabricServicePartitionInformation
	defer func() {
		bufferedValue = p_0.toGoStruct()
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().GetPartitionInfo,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(&p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStatefulServicePartition) GetReadStatus() (readStatus FabricServicePartitionAccessStatus, err error) {
	var p_0 FabricServicePartitionAccessStatus
	defer func() {
		readStatus = p_0
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().GetReadStatus,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(&p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStatefulServicePartition) GetWriteStatus() (writeStatus FabricServicePartitionAccessStatus, err error) {
	var p_0 FabricServicePartitionAccessStatus
	defer func() {
		writeStatus = p_0
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().GetWriteStatus,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(&p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStatefulServicePartition) CreateReplicator(
	stateProvider *ComFabricStateProvider,
	replicatorSettings *FabricReplicatorSettings,
) (replicator *ComFabricReplicator, stateReplicator *ComFabricStateReplicator, err error) {
	var p_1 *innerFabricReplicatorSettings
	p_1 = replicatorSettings.toInnerStruct()
	var p_2 *ComFabricReplicator
	defer func() {
		replicator = p_2
	}()
	var p_3 *ComFabricStateReplicator
	defer func() {
		stateReplicator = p_3
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().CreateReplicator,
		5,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(stateProvider)),
		uintptr(unsafe.Pointer(p_1)),
		uintptr(unsafe.Pointer(&p_2)),
		uintptr(unsafe.Pointer(&p_3)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStatefulServicePartition) ReportLoad(
	metricCount uint32,
	metrics *FabricLoadMetric,
) (err error) {
	var p_1 *innerFabricLoadMetric
	p_1 = metrics.toInnerStruct()
	hr, _, err1 := syscall.Syscall(
		v.VTable().ReportLoad,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(metricCount),
		uintptr(unsafe.Pointer(p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStatefulServicePartition) ReportFault(
	faultType FabricFaultType,
) (err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().ReportFault,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(faultType),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricStatefulServicePartition1() (*ComFabricStatefulServicePartition1, error) {
	var com *ComFabricStatefulServicePartition1
	err := c.createComObject("{c9c66f2f-9dff-4c87-bbe4-a08b4c4074cf}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricStatefulServicePartition1 struct {
	ComFabricStatefulServicePartition
}

type ComFabricStatefulServicePartition1Vtbl struct {
	ComFabricStatefulServicePartitionVtbl
	ReportMoveCost uintptr
}

func (v *ComFabricStatefulServicePartition1) VTable() *ComFabricStatefulServicePartition1Vtbl {
	return (*ComFabricStatefulServicePartition1Vtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricStatefulServicePartition1) ReportMoveCost(
	moveCost FabricMoveCost,
) (err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().ReportMoveCost,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(moveCost),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricStatefulServicePartition2() (*ComFabricStatefulServicePartition2, error) {
	var com *ComFabricStatefulServicePartition2
	err := c.createComObject("{df27b476-fa25-459f-a7d3-87d3eec9c73c}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricStatefulServicePartition2 struct {
	ComFabricStatefulServicePartition1
}

type ComFabricStatefulServicePartition2Vtbl struct {
	ComFabricStatefulServicePartition1Vtbl
	ReportReplicaHealth   uintptr
	ReportPartitionHealth uintptr
}

func (v *ComFabricStatefulServicePartition2) VTable() *ComFabricStatefulServicePartition2Vtbl {
	return (*ComFabricStatefulServicePartition2Vtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricStatefulServicePartition2) ReportReplicaHealth(
	healthInfo *FabricHealthInformation,
) (err error) {
	var p_0 *innerFabricHealthInformation
	p_0 = healthInfo.toInnerStruct()
	hr, _, err1 := syscall.Syscall(
		v.VTable().ReportReplicaHealth,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStatefulServicePartition2) ReportPartitionHealth(
	healthInfo *FabricHealthInformation,
) (err error) {
	var p_0 *innerFabricHealthInformation
	p_0 = healthInfo.toInnerStruct()
	hr, _, err1 := syscall.Syscall(
		v.VTable().ReportPartitionHealth,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricStatefulServicePartition3() (*ComFabricStatefulServicePartition3, error) {
	var com *ComFabricStatefulServicePartition3
	err := c.createComObject("{51f1269d-b061-4c1c-96cf-6508cece813b}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricStatefulServicePartition3 struct {
	ComFabricStatefulServicePartition2
}

type ComFabricStatefulServicePartition3Vtbl struct {
	ComFabricStatefulServicePartition2Vtbl
	ReportReplicaHealth2   uintptr
	ReportPartitionHealth2 uintptr
}

func (v *ComFabricStatefulServicePartition3) VTable() *ComFabricStatefulServicePartition3Vtbl {
	return (*ComFabricStatefulServicePartition3Vtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricStatefulServicePartition3) ReportReplicaHealth2(
	healthInfo *FabricHealthInformation,
	sendOptions *FabricHealthReportSendOptions,
) (err error) {
	var p_0 *innerFabricHealthInformation
	p_0 = healthInfo.toInnerStruct()
	var p_1 *innerFabricHealthReportSendOptions
	p_1 = sendOptions.toInnerStruct()
	hr, _, err1 := syscall.Syscall(
		v.VTable().ReportReplicaHealth2,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStatefulServicePartition3) ReportPartitionHealth2(
	healthInfo *FabricHealthInformation,
	sendOptions *FabricHealthReportSendOptions,
) (err error) {
	var p_0 *innerFabricHealthInformation
	p_0 = healthInfo.toInnerStruct()
	var p_1 *innerFabricHealthReportSendOptions
	p_1 = sendOptions.toInnerStruct()
	hr, _, err1 := syscall.Syscall(
		v.VTable().ReportPartitionHealth2,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricStateReplicator() (*ComFabricStateReplicator, error) {
	var com *ComFabricStateReplicator
	err := c.createComObject("{89e9a978-c771-44f2-92e8-3bf271cabe9c}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricStateReplicator struct {
	ole.IUnknown
}

type ComFabricStateReplicatorVtbl struct {
	ole.IUnknownVtbl
	BeginReplicate           uintptr
	EndReplicate             uintptr
	GetReplicationStream     uintptr
	GetCopyStream            uintptr
	UpdateReplicatorSettings uintptr
}

func (v *ComFabricStateReplicator) VTable() *ComFabricStateReplicatorVtbl {
	return (*ComFabricStateReplicatorVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricStateReplicator) beginReplicate(
	operationData *ComFabricOperationData,
	callback *comIFabricAsyncOperationCallback,
) (sequenceNumber int64, context *comIFabricAsyncOperationContext, err error) {
	var p_2 int64
	defer func() {
		sequenceNumber = p_2
	}()
	var p_3 *comIFabricAsyncOperationContext
	defer func() {
		context = p_3
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().BeginReplicate,
		5,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(operationData)),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_2)),
		uintptr(unsafe.Pointer(&p_3)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStateReplicator) endReplicate(
	context *comIFabricAsyncOperationContext,
) (sequenceNumber int64, err error) {
	var p_1 int64
	defer func() {
		sequenceNumber = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().EndReplicate,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(context)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStateReplicator) GetReplicationStream() (stream *ComFabricOperationStream, err error) {
	var p_0 *ComFabricOperationStream
	defer func() {
		stream = p_0
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().GetReplicationStream,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(&p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStateReplicator) GetCopyStream() (stream *ComFabricOperationStream, err error) {
	var p_0 *ComFabricOperationStream
	defer func() {
		stream = p_0
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().GetCopyStream,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(&p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStateReplicator) UpdateReplicatorSettings(
	replicatorSettings *FabricReplicatorSettings,
) (err error) {
	var p_0 *innerFabricReplicatorSettings
	p_0 = replicatorSettings.toInnerStruct()
	hr, _, err1 := syscall.Syscall(
		v.VTable().UpdateReplicatorSettings,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStateReplicator) Replicate(
	ctx context.Context,
	operationData *ComFabricOperationData,
	sequenceNumber *int64,
) (result_0 int64, err error) {
	ch := make(chan error, 1)
	defer close(ch)
	callback := newFabricAsyncOperationCallback(func(sfctx *comIFabricAsyncOperationContext) {

		rt_1, err := v.endReplicate(sfctx)

		if err != nil {
			ch <- err
			return
		}
		if err != nil {
			ch <- err
			return
		}
		result_0 = rt_1
		ch <- nil
	})

	var timeout time.Duration
	{
		deadline, ok := ctx.Deadline()
		if ok {
			timeout = deadline.Sub(time.Now())
		} else {
			timeout = 15 * time.Minute
		}

		_ = timeout
	}
	_, sfctx, err := v.beginReplicate(
		operationData,
		callback,
	)

	if err != nil {
		return
	}

	select {
	case err = <-ch:
		return

	case <-ctx.Done():
		sfctx.Cancel()
		err = ctx.Err()
		return
	case <-time.After(timeout):
		sfctx.Cancel()
		err = FabricErrorTimeout
		return
	}

}

func (c *FabricClient) CreateFabricStateReplicator2() (*ComFabricStateReplicator2, error) {
	var com *ComFabricStateReplicator2
	err := c.createComObject("{4A28D542-658F-46F9-9BF4-79B7CAE25C5D}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricStateReplicator2 struct {
	ComFabricStateReplicator
}

type ComFabricStateReplicator2Vtbl struct {
	ComFabricStateReplicatorVtbl
	GetReplicatorSettings uintptr
}

func (v *ComFabricStateReplicator2) VTable() *ComFabricStateReplicator2Vtbl {
	return (*ComFabricStateReplicator2Vtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricStateReplicator2) GetReplicatorSettings() (replicatorSettings *ComFabricReplicatorSettingsResult, err error) {
	var p_0 *ComFabricReplicatorSettingsResult
	defer func() {
		replicatorSettings = p_0
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().GetReplicatorSettings,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(&p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricStateProvider() (*ComFabricStateProvider, error) {
	var com *ComFabricStateProvider
	err := c.createComObject("{3ebfec79-bd27-43f3-8be8-da38ee723951}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricStateProvider struct {
	ole.IUnknown
}

type ComFabricStateProviderVtbl struct {
	ole.IUnknownVtbl
	BeginUpdateEpoch               uintptr
	EndUpdateEpoch                 uintptr
	GetLastCommittedSequenceNumber uintptr
	BeginOnDataLoss                uintptr
	EndOnDataLoss                  uintptr
	GetCopyContext                 uintptr
	GetCopyState                   uintptr
}

func (v *ComFabricStateProvider) VTable() *ComFabricStateProviderVtbl {
	return (*ComFabricStateProviderVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricStateProvider) beginUpdateEpoch(
	epoch *FabricEpoch,
	previousEpochLastSequenceNumber int64,
	callback *comIFabricAsyncOperationCallback,
) (context *comIFabricAsyncOperationContext, err error) {
	var p_0 *innerFabricEpoch
	p_0 = epoch.toInnerStruct()
	var p_3 *comIFabricAsyncOperationContext
	defer func() {
		context = p_3
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().BeginUpdateEpoch,
		5,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(previousEpochLastSequenceNumber),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_3)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStateProvider) endUpdateEpoch(
	context *comIFabricAsyncOperationContext,
) (err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().EndUpdateEpoch,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(context)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStateProvider) GetLastCommittedSequenceNumber() (sequenceNumber int64, err error) {
	var p_0 int64
	defer func() {
		sequenceNumber = p_0
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().GetLastCommittedSequenceNumber,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(&p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStateProvider) beginOnDataLoss(
	callback *comIFabricAsyncOperationCallback,
) (context *comIFabricAsyncOperationContext, err error) {
	var p_1 *comIFabricAsyncOperationContext
	defer func() {
		context = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().BeginOnDataLoss,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStateProvider) endOnDataLoss(
	context *comIFabricAsyncOperationContext,
) (isStateChanged bool, err error) {
	var p_1 bool
	defer func() {
		isStateChanged = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().EndOnDataLoss,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(context)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStateProvider) GetCopyContext() (copyContextStream *ComFabricOperationDataStream, err error) {
	var p_0 *ComFabricOperationDataStream
	defer func() {
		copyContextStream = p_0
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().GetCopyContext,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(&p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStateProvider) GetCopyState(
	uptoSequenceNumber int64,
	copyContextStream *ComFabricOperationDataStream,
) (copyStateStream *ComFabricOperationDataStream, err error) {
	var p_2 *ComFabricOperationDataStream
	defer func() {
		copyStateStream = p_2
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().GetCopyState,
		4,
		uintptr(unsafe.Pointer(v)),
		uintptr(uptoSequenceNumber),
		uintptr(unsafe.Pointer(copyContextStream)),
		uintptr(unsafe.Pointer(&p_2)),
		0,
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStateProvider) UpdateEpoch(
	ctx context.Context,
	epoch *FabricEpoch,
	previousEpochLastSequenceNumber int64,
) (err error) {
	ch := make(chan error, 1)
	defer close(ch)
	callback := newFabricAsyncOperationCallback(func(sfctx *comIFabricAsyncOperationContext) {

		err := v.endUpdateEpoch(sfctx)

		if err != nil {
			ch <- err
			return
		}
		if err != nil {
			ch <- err
			return
		}
		ch <- nil
	})

	var timeout time.Duration
	{
		deadline, ok := ctx.Deadline()
		if ok {
			timeout = deadline.Sub(time.Now())
		} else {
			timeout = 15 * time.Minute
		}

		_ = timeout
	}
	sfctx, err := v.beginUpdateEpoch(
		epoch,
		previousEpochLastSequenceNumber,
		callback,
	)

	if err != nil {
		return
	}

	select {
	case err = <-ch:
		return

	case <-ctx.Done():
		sfctx.Cancel()
		err = ctx.Err()
		return
	case <-time.After(timeout):
		sfctx.Cancel()
		err = FabricErrorTimeout
		return
	}

}
func (v *ComFabricStateProvider) OnDataLoss(
	ctx context.Context,
) (result_0 bool, err error) {
	ch := make(chan error, 1)
	defer close(ch)
	callback := newFabricAsyncOperationCallback(func(sfctx *comIFabricAsyncOperationContext) {

		rt_1, err := v.endOnDataLoss(sfctx)

		if err != nil {
			ch <- err
			return
		}
		if err != nil {
			ch <- err
			return
		}
		result_0 = rt_1
		ch <- nil
	})

	var timeout time.Duration
	{
		deadline, ok := ctx.Deadline()
		if ok {
			timeout = deadline.Sub(time.Now())
		} else {
			timeout = 15 * time.Minute
		}

		_ = timeout
	}
	sfctx, err := v.beginOnDataLoss(
		callback,
	)

	if err != nil {
		return
	}

	select {
	case err = <-ch:
		return

	case <-ctx.Done():
		sfctx.Cancel()
		err = ctx.Err()
		return
	case <-time.After(timeout):
		sfctx.Cancel()
		err = FabricErrorTimeout
		return
	}

}

func (c *FabricClient) CreateFabricOperation() (*ComFabricOperation, error) {
	var com *ComFabricOperation
	err := c.createComObject("{f4ad6bfa-e23c-4a48-9617-c099cd59a23a}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricOperation struct {
	ole.IUnknown
}

type ComFabricOperationVtbl struct {
	ole.IUnknownVtbl
	get_Metadata uintptr
	GetData      uintptr
	Acknowledge  uintptr
}

func (v *ComFabricOperation) VTable() *ComFabricOperationVtbl {
	return (*ComFabricOperationVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricOperation) GetMetadata() (rt *FabricOperationMetadata, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_Metadata,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*innerFabricOperationMetadata)(unsafe.Pointer(hr))

	rt = tmp.toGoStruct()
	return
}
func (v *ComFabricOperation) GetData() (count uint32, buffers *FabricOperationDataBuffer, err error) {
	var p_0 uint32
	defer func() {
		count = p_0
	}()
	var p_1 *innerFabricOperationDataBuffer
	defer func() {
		buffers = p_1.toGoStruct()
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().GetData,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(&p_0)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricOperation) Acknowledge() (err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().Acknowledge,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricOperationData() (*ComFabricOperationData, error) {
	var com *ComFabricOperationData
	err := c.createComObject("{bab8ad87-37b7-482a-985d-baf38a785dcd}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricOperationData struct {
	ole.IUnknown
}

type ComFabricOperationDataVtbl struct {
	ole.IUnknownVtbl
	GetData uintptr
}

func (v *ComFabricOperationData) VTable() *ComFabricOperationDataVtbl {
	return (*ComFabricOperationDataVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricOperationData) GetData() (count uint32, buffers *FabricOperationDataBuffer, err error) {
	var p_0 uint32
	defer func() {
		count = p_0
	}()
	var p_1 *innerFabricOperationDataBuffer
	defer func() {
		buffers = p_1.toGoStruct()
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().GetData,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(&p_0)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricOperationStream() (*ComFabricOperationStream, error) {
	var com *ComFabricOperationStream
	err := c.createComObject("{A98FB97A-D6B0-408A-A878-A9EDB09C2587}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricOperationStream struct {
	ole.IUnknown
}

type ComFabricOperationStreamVtbl struct {
	ole.IUnknownVtbl
	BeginGetOperation uintptr
	EndGetOperation   uintptr
}

func (v *ComFabricOperationStream) VTable() *ComFabricOperationStreamVtbl {
	return (*ComFabricOperationStreamVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricOperationStream) beginGetOperation(
	callback *comIFabricAsyncOperationCallback,
) (context *comIFabricAsyncOperationContext, err error) {
	var p_1 *comIFabricAsyncOperationContext
	defer func() {
		context = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().BeginGetOperation,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricOperationStream2() (*ComFabricOperationStream2, error) {
	var com *ComFabricOperationStream2
	err := c.createComObject("{0930199B-590A-4065-BEC9-5F93B6AAE086}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricOperationStream2 struct {
	ComFabricOperationStream
}

type ComFabricOperationStream2Vtbl struct {
	ComFabricOperationStreamVtbl
	ReportFault uintptr
}

func (v *ComFabricOperationStream2) VTable() *ComFabricOperationStream2Vtbl {
	return (*ComFabricOperationStream2Vtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricOperationStream2) ReportFault(
	faultType FabricFaultType,
) (err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().ReportFault,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(faultType),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricOperationDataStream() (*ComFabricOperationDataStream, error) {
	var com *ComFabricOperationDataStream
	err := c.createComObject("{c4e9084c-be92-49c9-8c18-d44d088c2e32}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricOperationDataStream struct {
	ole.IUnknown
}

type ComFabricOperationDataStreamVtbl struct {
	ole.IUnknownVtbl
	BeginGetNext uintptr
	EndGetNext   uintptr
}

func (v *ComFabricOperationDataStream) VTable() *ComFabricOperationDataStreamVtbl {
	return (*ComFabricOperationDataStreamVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricOperationDataStream) beginGetNext(
	callback *comIFabricAsyncOperationCallback,
) (context *comIFabricAsyncOperationContext, err error) {
	var p_1 *comIFabricAsyncOperationContext
	defer func() {
		context = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().BeginGetNext,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricReplicator() (*ComFabricReplicator, error) {
	var com *ComFabricReplicator
	err := c.createComObject("{067f144a-e5be-4f5e-a181-8b5593e20242}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricReplicator struct {
	ole.IUnknown
}

type ComFabricReplicatorVtbl struct {
	ole.IUnknownVtbl
	BeginOpen            uintptr
	EndOpen              uintptr
	BeginChangeRole      uintptr
	EndChangeRole        uintptr
	BeginUpdateEpoch     uintptr
	EndUpdateEpoch       uintptr
	BeginClose           uintptr
	EndClose             uintptr
	Abort                uintptr
	GetCurrentProgress   uintptr
	GetCatchUpCapability uintptr
}

func (v *ComFabricReplicator) VTable() *ComFabricReplicatorVtbl {
	return (*ComFabricReplicatorVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricReplicator) beginOpen(
	callback *comIFabricAsyncOperationCallback,
) (context *comIFabricAsyncOperationContext, err error) {
	var p_1 *comIFabricAsyncOperationContext
	defer func() {
		context = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().BeginOpen,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricReplicator) beginChangeRole(
	epoch *FabricEpoch,
	role FabricReplicaRole,
	callback *comIFabricAsyncOperationCallback,
) (context *comIFabricAsyncOperationContext, err error) {
	var p_0 *innerFabricEpoch
	p_0 = epoch.toInnerStruct()
	var p_3 *comIFabricAsyncOperationContext
	defer func() {
		context = p_3
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().BeginChangeRole,
		5,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(role),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_3)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricReplicator) endChangeRole(
	context *comIFabricAsyncOperationContext,
) (err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().EndChangeRole,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(context)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricReplicator) beginUpdateEpoch(
	epoch *FabricEpoch,
	callback *comIFabricAsyncOperationCallback,
) (context *comIFabricAsyncOperationContext, err error) {
	var p_0 *innerFabricEpoch
	p_0 = epoch.toInnerStruct()
	var p_2 *comIFabricAsyncOperationContext
	defer func() {
		context = p_2
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().BeginUpdateEpoch,
		4,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_2)),
		0,
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricReplicator) endUpdateEpoch(
	context *comIFabricAsyncOperationContext,
) (err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().EndUpdateEpoch,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(context)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricReplicator) beginClose(
	callback *comIFabricAsyncOperationCallback,
) (context *comIFabricAsyncOperationContext, err error) {
	var p_1 *comIFabricAsyncOperationContext
	defer func() {
		context = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().BeginClose,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricReplicator) endClose(
	context *comIFabricAsyncOperationContext,
) (err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().EndClose,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(context)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricReplicator) Abort() (rt interface{}, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().Abort,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (unsafe.Pointer)(unsafe.Pointer(hr))

	rt = fromUnsafePointer(tmp)
	return
}
func (v *ComFabricReplicator) GetCurrentProgress() (lastSequenceNumber int64, err error) {
	var p_0 int64
	defer func() {
		lastSequenceNumber = p_0
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().GetCurrentProgress,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(&p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricReplicator) GetCatchUpCapability() (fromSequenceNumber int64, err error) {
	var p_0 int64
	defer func() {
		fromSequenceNumber = p_0
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().GetCatchUpCapability,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(&p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricReplicator) ChangeRole(
	ctx context.Context,
	epoch *FabricEpoch,
	role FabricReplicaRole,
) (err error) {
	ch := make(chan error, 1)
	defer close(ch)
	callback := newFabricAsyncOperationCallback(func(sfctx *comIFabricAsyncOperationContext) {

		err := v.endChangeRole(sfctx)

		if err != nil {
			ch <- err
			return
		}
		if err != nil {
			ch <- err
			return
		}
		ch <- nil
	})

	var timeout time.Duration
	{
		deadline, ok := ctx.Deadline()
		if ok {
			timeout = deadline.Sub(time.Now())
		} else {
			timeout = 15 * time.Minute
		}

		_ = timeout
	}
	sfctx, err := v.beginChangeRole(
		epoch,
		role,
		callback,
	)

	if err != nil {
		return
	}

	select {
	case err = <-ch:
		return

	case <-ctx.Done():
		sfctx.Cancel()
		err = ctx.Err()
		return
	case <-time.After(timeout):
		sfctx.Cancel()
		err = FabricErrorTimeout
		return
	}

}
func (v *ComFabricReplicator) UpdateEpoch(
	ctx context.Context,
	epoch *FabricEpoch,
) (err error) {
	ch := make(chan error, 1)
	defer close(ch)
	callback := newFabricAsyncOperationCallback(func(sfctx *comIFabricAsyncOperationContext) {

		err := v.endUpdateEpoch(sfctx)

		if err != nil {
			ch <- err
			return
		}
		if err != nil {
			ch <- err
			return
		}
		ch <- nil
	})

	var timeout time.Duration
	{
		deadline, ok := ctx.Deadline()
		if ok {
			timeout = deadline.Sub(time.Now())
		} else {
			timeout = 15 * time.Minute
		}

		_ = timeout
	}
	sfctx, err := v.beginUpdateEpoch(
		epoch,
		callback,
	)

	if err != nil {
		return
	}

	select {
	case err = <-ch:
		return

	case <-ctx.Done():
		sfctx.Cancel()
		err = ctx.Err()
		return
	case <-time.After(timeout):
		sfctx.Cancel()
		err = FabricErrorTimeout
		return
	}

}
func (v *ComFabricReplicator) Close(
	ctx context.Context,
) (err error) {
	ch := make(chan error, 1)
	defer close(ch)
	callback := newFabricAsyncOperationCallback(func(sfctx *comIFabricAsyncOperationContext) {

		err := v.endClose(sfctx)

		if err != nil {
			ch <- err
			return
		}
		if err != nil {
			ch <- err
			return
		}
		ch <- nil
	})

	var timeout time.Duration
	{
		deadline, ok := ctx.Deadline()
		if ok {
			timeout = deadline.Sub(time.Now())
		} else {
			timeout = 15 * time.Minute
		}

		_ = timeout
	}
	sfctx, err := v.beginClose(
		callback,
	)

	if err != nil {
		return
	}

	select {
	case err = <-ch:
		return

	case <-ctx.Done():
		sfctx.Cancel()
		err = ctx.Err()
		return
	case <-time.After(timeout):
		sfctx.Cancel()
		err = FabricErrorTimeout
		return
	}

}

func (c *FabricClient) CreateFabricPrimaryReplicator() (*ComFabricPrimaryReplicator, error) {
	var com *ComFabricPrimaryReplicator
	err := c.createComObject("{564e50dd-c3a4-4600-a60e-6658874307ae}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricPrimaryReplicator struct {
	ComFabricReplicator
}

type ComFabricPrimaryReplicatorVtbl struct {
	ComFabricReplicatorVtbl
	BeginOnDataLoss                      uintptr
	EndOnDataLoss                        uintptr
	UpdateCatchUpReplicaSetConfiguration uintptr
	BeginWaitForCatchUpQuorum            uintptr
	EndWaitForCatchUpQuorum              uintptr
	UpdateCurrentReplicaSetConfiguration uintptr
	BeginBuildReplica                    uintptr
	EndBuildReplica                      uintptr
	RemoveReplica                        uintptr
}

func (v *ComFabricPrimaryReplicator) VTable() *ComFabricPrimaryReplicatorVtbl {
	return (*ComFabricPrimaryReplicatorVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricPrimaryReplicator) beginOnDataLoss(
	callback *comIFabricAsyncOperationCallback,
) (context *comIFabricAsyncOperationContext, err error) {
	var p_1 *comIFabricAsyncOperationContext
	defer func() {
		context = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().BeginOnDataLoss,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricPrimaryReplicator) endOnDataLoss(
	context *comIFabricAsyncOperationContext,
) (isStateChanged bool, err error) {
	var p_1 bool
	defer func() {
		isStateChanged = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().EndOnDataLoss,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(context)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricPrimaryReplicator) UpdateCatchUpReplicaSetConfiguration(
	currentConfiguration *FabricReplicaSetConfiguration,
	previousConfiguration *FabricReplicaSetConfiguration,
) (err error) {
	var p_0 *innerFabricReplicaSetConfiguration
	p_0 = currentConfiguration.toInnerStruct()
	var p_1 *innerFabricReplicaSetConfiguration
	p_1 = previousConfiguration.toInnerStruct()
	hr, _, err1 := syscall.Syscall(
		v.VTable().UpdateCatchUpReplicaSetConfiguration,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricPrimaryReplicator) beginWaitForCatchUpQuorum(
	catchUpMode FabricReplicaSetQuorumMode,
	callback *comIFabricAsyncOperationCallback,
) (context *comIFabricAsyncOperationContext, err error) {
	var p_2 *comIFabricAsyncOperationContext
	defer func() {
		context = p_2
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().BeginWaitForCatchUpQuorum,
		4,
		uintptr(unsafe.Pointer(v)),
		uintptr(catchUpMode),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_2)),
		0,
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricPrimaryReplicator) endWaitForCatchUpQuorum(
	context *comIFabricAsyncOperationContext,
) (err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().EndWaitForCatchUpQuorum,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(context)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricPrimaryReplicator) UpdateCurrentReplicaSetConfiguration(
	currentConfiguration *FabricReplicaSetConfiguration,
) (err error) {
	var p_0 *innerFabricReplicaSetConfiguration
	p_0 = currentConfiguration.toInnerStruct()
	hr, _, err1 := syscall.Syscall(
		v.VTable().UpdateCurrentReplicaSetConfiguration,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricPrimaryReplicator) beginBuildReplica(
	replica *FabricReplicaInformation,
	callback *comIFabricAsyncOperationCallback,
) (context *comIFabricAsyncOperationContext, err error) {
	var p_0 *innerFabricReplicaInformation
	p_0 = replica.toInnerStruct()
	var p_2 *comIFabricAsyncOperationContext
	defer func() {
		context = p_2
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().BeginBuildReplica,
		4,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_2)),
		0,
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricPrimaryReplicator) endBuildReplica(
	context *comIFabricAsyncOperationContext,
) (err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().EndBuildReplica,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(context)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricPrimaryReplicator) RemoveReplica(
	replicaId int64,
) (err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().RemoveReplica,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(replicaId),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricPrimaryReplicator) OnDataLoss(
	ctx context.Context,
) (result_0 bool, err error) {
	ch := make(chan error, 1)
	defer close(ch)
	callback := newFabricAsyncOperationCallback(func(sfctx *comIFabricAsyncOperationContext) {

		rt_1, err := v.endOnDataLoss(sfctx)

		if err != nil {
			ch <- err
			return
		}
		if err != nil {
			ch <- err
			return
		}
		result_0 = rt_1
		ch <- nil
	})

	var timeout time.Duration
	{
		deadline, ok := ctx.Deadline()
		if ok {
			timeout = deadline.Sub(time.Now())
		} else {
			timeout = 15 * time.Minute
		}

		_ = timeout
	}
	sfctx, err := v.beginOnDataLoss(
		callback,
	)

	if err != nil {
		return
	}

	select {
	case err = <-ch:
		return

	case <-ctx.Done():
		sfctx.Cancel()
		err = ctx.Err()
		return
	case <-time.After(timeout):
		sfctx.Cancel()
		err = FabricErrorTimeout
		return
	}

}
func (v *ComFabricPrimaryReplicator) WaitForCatchUpQuorum(
	ctx context.Context,
	catchUpMode FabricReplicaSetQuorumMode,
) (err error) {
	ch := make(chan error, 1)
	defer close(ch)
	callback := newFabricAsyncOperationCallback(func(sfctx *comIFabricAsyncOperationContext) {

		err := v.endWaitForCatchUpQuorum(sfctx)

		if err != nil {
			ch <- err
			return
		}
		if err != nil {
			ch <- err
			return
		}
		ch <- nil
	})

	var timeout time.Duration
	{
		deadline, ok := ctx.Deadline()
		if ok {
			timeout = deadline.Sub(time.Now())
		} else {
			timeout = 15 * time.Minute
		}

		_ = timeout
	}
	sfctx, err := v.beginWaitForCatchUpQuorum(
		catchUpMode,
		callback,
	)

	if err != nil {
		return
	}

	select {
	case err = <-ch:
		return

	case <-ctx.Done():
		sfctx.Cancel()
		err = ctx.Err()
		return
	case <-time.After(timeout):
		sfctx.Cancel()
		err = FabricErrorTimeout
		return
	}

}
func (v *ComFabricPrimaryReplicator) BuildReplica(
	ctx context.Context,
	replica *FabricReplicaInformation,
) (err error) {
	ch := make(chan error, 1)
	defer close(ch)
	callback := newFabricAsyncOperationCallback(func(sfctx *comIFabricAsyncOperationContext) {

		err := v.endBuildReplica(sfctx)

		if err != nil {
			ch <- err
			return
		}
		if err != nil {
			ch <- err
			return
		}
		ch <- nil
	})

	var timeout time.Duration
	{
		deadline, ok := ctx.Deadline()
		if ok {
			timeout = deadline.Sub(time.Now())
		} else {
			timeout = 15 * time.Minute
		}

		_ = timeout
	}
	sfctx, err := v.beginBuildReplica(
		replica,
		callback,
	)

	if err != nil {
		return
	}

	select {
	case err = <-ch:
		return

	case <-ctx.Done():
		sfctx.Cancel()
		err = ctx.Err()
		return
	case <-time.After(timeout):
		sfctx.Cancel()
		err = FabricErrorTimeout
		return
	}

}

func (c *FabricClient) CreateFabricReplicatorCatchupSpecificQuorum() (*ComFabricReplicatorCatchupSpecificQuorum, error) {
	var com *ComFabricReplicatorCatchupSpecificQuorum
	err := c.createComObject("{aa3116fe-277d-482d-bd16-5366fa405757}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricReplicatorCatchupSpecificQuorum struct {
	ole.IUnknown
}

type ComFabricReplicatorCatchupSpecificQuorumVtbl struct {
	ole.IUnknownVtbl
}

func (v *ComFabricReplicatorCatchupSpecificQuorum) VTable() *ComFabricReplicatorCatchupSpecificQuorumVtbl {
	return (*ComFabricReplicatorCatchupSpecificQuorumVtbl)(unsafe.Pointer(v.RawVTable))
}

func (c *FabricClient) CreateFabricAtomicGroupStateReplicator() (*ComFabricAtomicGroupStateReplicator, error) {
	var com *ComFabricAtomicGroupStateReplicator
	err := c.createComObject("{80d2155c-4fc2-4fde-9696-c2f39b471c3d}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricAtomicGroupStateReplicator struct {
	ole.IUnknown
}

type ComFabricAtomicGroupStateReplicatorVtbl struct {
	ole.IUnknownVtbl
	CreateAtomicGroup                  uintptr
	BeginReplicateAtomicGroupOperation uintptr
	EndReplicateAtomicGroupOperation   uintptr
	BeginReplicateAtomicGroupCommit    uintptr
	EndReplicateAtomicGroupCommit      uintptr
	BeginReplicateAtomicGroupRollback  uintptr
	EndReplicateAtomicGroupRollback    uintptr
}

func (v *ComFabricAtomicGroupStateReplicator) VTable() *ComFabricAtomicGroupStateReplicatorVtbl {
	return (*ComFabricAtomicGroupStateReplicatorVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricAtomicGroupStateReplicator) CreateAtomicGroup() (AtomicGroupId int64, err error) {
	var p_0 int64
	defer func() {
		AtomicGroupId = p_0
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().CreateAtomicGroup,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(&p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricAtomicGroupStateReplicator) beginReplicateAtomicGroupOperation(
	atomicGroupId int64,
	operationData *ComFabricOperationData,
	callback *comIFabricAsyncOperationCallback,
) (operationSequenceNumber int64, context *comIFabricAsyncOperationContext, err error) {
	var p_3 int64
	defer func() {
		operationSequenceNumber = p_3
	}()
	var p_4 *comIFabricAsyncOperationContext
	defer func() {
		context = p_4
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().BeginReplicateAtomicGroupOperation,
		6,
		uintptr(unsafe.Pointer(v)),
		uintptr(atomicGroupId),
		uintptr(unsafe.Pointer(operationData)),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_3)),
		uintptr(unsafe.Pointer(&p_4)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricAtomicGroupStateReplicator) endReplicateAtomicGroupOperation(
	context *comIFabricAsyncOperationContext,
) (operationSequenceNumber int64, err error) {
	var p_1 int64
	defer func() {
		operationSequenceNumber = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().EndReplicateAtomicGroupOperation,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(context)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricAtomicGroupStateReplicator) beginReplicateAtomicGroupCommit(
	atomicGroupId int64,
	callback *comIFabricAsyncOperationCallback,
) (commitSequenceNumber int64, context *comIFabricAsyncOperationContext, err error) {
	var p_2 int64
	defer func() {
		commitSequenceNumber = p_2
	}()
	var p_3 *comIFabricAsyncOperationContext
	defer func() {
		context = p_3
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().BeginReplicateAtomicGroupCommit,
		5,
		uintptr(unsafe.Pointer(v)),
		uintptr(atomicGroupId),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_2)),
		uintptr(unsafe.Pointer(&p_3)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricAtomicGroupStateReplicator) endReplicateAtomicGroupCommit(
	context *comIFabricAsyncOperationContext,
) (commitSequenceNumber int64, err error) {
	var p_1 int64
	defer func() {
		commitSequenceNumber = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().EndReplicateAtomicGroupCommit,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(context)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricAtomicGroupStateReplicator) beginReplicateAtomicGroupRollback(
	atomicGroupId int64,
	callback *comIFabricAsyncOperationCallback,
) (rollbackSequenceNumber int64, context *comIFabricAsyncOperationContext, err error) {
	var p_2 int64
	defer func() {
		rollbackSequenceNumber = p_2
	}()
	var p_3 *comIFabricAsyncOperationContext
	defer func() {
		context = p_3
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().BeginReplicateAtomicGroupRollback,
		5,
		uintptr(unsafe.Pointer(v)),
		uintptr(atomicGroupId),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_2)),
		uintptr(unsafe.Pointer(&p_3)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricAtomicGroupStateReplicator) endReplicateAtomicGroupRollback(
	context *comIFabricAsyncOperationContext,
) (rollbackSequenceNumber int64, err error) {
	var p_1 int64
	defer func() {
		rollbackSequenceNumber = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().EndReplicateAtomicGroupRollback,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(context)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricAtomicGroupStateReplicator) ReplicateAtomicGroupOperation(
	ctx context.Context,
	atomicGroupId int64,
	operationData *ComFabricOperationData,
	operationSequenceNumber *int64,
) (result_0 int64, err error) {
	ch := make(chan error, 1)
	defer close(ch)
	callback := newFabricAsyncOperationCallback(func(sfctx *comIFabricAsyncOperationContext) {

		rt_1, err := v.endReplicateAtomicGroupOperation(sfctx)

		if err != nil {
			ch <- err
			return
		}
		if err != nil {
			ch <- err
			return
		}
		result_0 = rt_1
		ch <- nil
	})

	var timeout time.Duration
	{
		deadline, ok := ctx.Deadline()
		if ok {
			timeout = deadline.Sub(time.Now())
		} else {
			timeout = 15 * time.Minute
		}

		_ = timeout
	}
	_, sfctx, err := v.beginReplicateAtomicGroupOperation(
		atomicGroupId,
		operationData,
		callback,
	)

	if err != nil {
		return
	}

	select {
	case err = <-ch:
		return

	case <-ctx.Done():
		sfctx.Cancel()
		err = ctx.Err()
		return
	case <-time.After(timeout):
		sfctx.Cancel()
		err = FabricErrorTimeout
		return
	}

}
func (v *ComFabricAtomicGroupStateReplicator) ReplicateAtomicGroupCommit(
	ctx context.Context,
	atomicGroupId int64,
	commitSequenceNumber *int64,
) (result_0 int64, err error) {
	ch := make(chan error, 1)
	defer close(ch)
	callback := newFabricAsyncOperationCallback(func(sfctx *comIFabricAsyncOperationContext) {

		rt_1, err := v.endReplicateAtomicGroupCommit(sfctx)

		if err != nil {
			ch <- err
			return
		}
		if err != nil {
			ch <- err
			return
		}
		result_0 = rt_1
		ch <- nil
	})

	var timeout time.Duration
	{
		deadline, ok := ctx.Deadline()
		if ok {
			timeout = deadline.Sub(time.Now())
		} else {
			timeout = 15 * time.Minute
		}

		_ = timeout
	}
	_, sfctx, err := v.beginReplicateAtomicGroupCommit(
		atomicGroupId,
		callback,
	)

	if err != nil {
		return
	}

	select {
	case err = <-ch:
		return

	case <-ctx.Done():
		sfctx.Cancel()
		err = ctx.Err()
		return
	case <-time.After(timeout):
		sfctx.Cancel()
		err = FabricErrorTimeout
		return
	}

}
func (v *ComFabricAtomicGroupStateReplicator) ReplicateAtomicGroupRollback(
	ctx context.Context,
	atomicGroupId int64,
	rollbackSequenceNumber *int64,
) (result_0 int64, err error) {
	ch := make(chan error, 1)
	defer close(ch)
	callback := newFabricAsyncOperationCallback(func(sfctx *comIFabricAsyncOperationContext) {

		rt_1, err := v.endReplicateAtomicGroupRollback(sfctx)

		if err != nil {
			ch <- err
			return
		}
		if err != nil {
			ch <- err
			return
		}
		result_0 = rt_1
		ch <- nil
	})

	var timeout time.Duration
	{
		deadline, ok := ctx.Deadline()
		if ok {
			timeout = deadline.Sub(time.Now())
		} else {
			timeout = 15 * time.Minute
		}

		_ = timeout
	}
	_, sfctx, err := v.beginReplicateAtomicGroupRollback(
		atomicGroupId,
		callback,
	)

	if err != nil {
		return
	}

	select {
	case err = <-ch:
		return

	case <-ctx.Done():
		sfctx.Cancel()
		err = ctx.Err()
		return
	case <-time.After(timeout):
		sfctx.Cancel()
		err = FabricErrorTimeout
		return
	}

}

func (c *FabricClient) CreateFabricAtomicGroupStateProvider() (*ComFabricAtomicGroupStateProvider, error) {
	var com *ComFabricAtomicGroupStateProvider
	err := c.createComObject("{2b670953-6148-4f7d-a920-b390de43d913}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricAtomicGroupStateProvider struct {
	ole.IUnknown
}

type ComFabricAtomicGroupStateProviderVtbl struct {
	ole.IUnknownVtbl
	BeginAtomicGroupCommit   uintptr
	EndAtomicGroupCommit     uintptr
	BeginAtomicGroupRollback uintptr
	EndAtomicGroupRollback   uintptr
	BeginUndoProgress        uintptr
	EndUndoProgress          uintptr
}

func (v *ComFabricAtomicGroupStateProvider) VTable() *ComFabricAtomicGroupStateProviderVtbl {
	return (*ComFabricAtomicGroupStateProviderVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricAtomicGroupStateProvider) beginAtomicGroupCommit(
	atomicGroupId int64,
	commitSequenceNumber int64,
	callback *comIFabricAsyncOperationCallback,
) (context *comIFabricAsyncOperationContext, err error) {
	var p_3 *comIFabricAsyncOperationContext
	defer func() {
		context = p_3
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().BeginAtomicGroupCommit,
		5,
		uintptr(unsafe.Pointer(v)),
		uintptr(atomicGroupId),
		uintptr(commitSequenceNumber),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_3)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricAtomicGroupStateProvider) endAtomicGroupCommit(
	context *comIFabricAsyncOperationContext,
) (err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().EndAtomicGroupCommit,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(context)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricAtomicGroupStateProvider) beginAtomicGroupRollback(
	atomicGroupId int64,
	rollbackequenceNumber int64,
	callback *comIFabricAsyncOperationCallback,
) (context *comIFabricAsyncOperationContext, err error) {
	var p_3 *comIFabricAsyncOperationContext
	defer func() {
		context = p_3
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().BeginAtomicGroupRollback,
		5,
		uintptr(unsafe.Pointer(v)),
		uintptr(atomicGroupId),
		uintptr(rollbackequenceNumber),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_3)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricAtomicGroupStateProvider) endAtomicGroupRollback(
	context *comIFabricAsyncOperationContext,
) (err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().EndAtomicGroupRollback,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(context)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricAtomicGroupStateProvider) beginUndoProgress(
	fromCommitSequenceNumber int64,
	callback *comIFabricAsyncOperationCallback,
) (context *comIFabricAsyncOperationContext, err error) {
	var p_2 *comIFabricAsyncOperationContext
	defer func() {
		context = p_2
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().BeginUndoProgress,
		4,
		uintptr(unsafe.Pointer(v)),
		uintptr(fromCommitSequenceNumber),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_2)),
		0,
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricAtomicGroupStateProvider) endUndoProgress(
	context *comIFabricAsyncOperationContext,
) (err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().EndUndoProgress,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(context)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricAtomicGroupStateProvider) AtomicGroupCommit(
	ctx context.Context,
	atomicGroupId int64,
	commitSequenceNumber int64,
) (err error) {
	ch := make(chan error, 1)
	defer close(ch)
	callback := newFabricAsyncOperationCallback(func(sfctx *comIFabricAsyncOperationContext) {

		err := v.endAtomicGroupCommit(sfctx)

		if err != nil {
			ch <- err
			return
		}
		if err != nil {
			ch <- err
			return
		}
		ch <- nil
	})

	var timeout time.Duration
	{
		deadline, ok := ctx.Deadline()
		if ok {
			timeout = deadline.Sub(time.Now())
		} else {
			timeout = 15 * time.Minute
		}

		_ = timeout
	}
	sfctx, err := v.beginAtomicGroupCommit(
		atomicGroupId,
		commitSequenceNumber,
		callback,
	)

	if err != nil {
		return
	}

	select {
	case err = <-ch:
		return

	case <-ctx.Done():
		sfctx.Cancel()
		err = ctx.Err()
		return
	case <-time.After(timeout):
		sfctx.Cancel()
		err = FabricErrorTimeout
		return
	}

}
func (v *ComFabricAtomicGroupStateProvider) AtomicGroupRollback(
	ctx context.Context,
	atomicGroupId int64,
	rollbackequenceNumber int64,
) (err error) {
	ch := make(chan error, 1)
	defer close(ch)
	callback := newFabricAsyncOperationCallback(func(sfctx *comIFabricAsyncOperationContext) {

		err := v.endAtomicGroupRollback(sfctx)

		if err != nil {
			ch <- err
			return
		}
		if err != nil {
			ch <- err
			return
		}
		ch <- nil
	})

	var timeout time.Duration
	{
		deadline, ok := ctx.Deadline()
		if ok {
			timeout = deadline.Sub(time.Now())
		} else {
			timeout = 15 * time.Minute
		}

		_ = timeout
	}
	sfctx, err := v.beginAtomicGroupRollback(
		atomicGroupId,
		rollbackequenceNumber,
		callback,
	)

	if err != nil {
		return
	}

	select {
	case err = <-ch:
		return

	case <-ctx.Done():
		sfctx.Cancel()
		err = ctx.Err()
		return
	case <-time.After(timeout):
		sfctx.Cancel()
		err = FabricErrorTimeout
		return
	}

}
func (v *ComFabricAtomicGroupStateProvider) UndoProgress(
	ctx context.Context,
	fromCommitSequenceNumber int64,
) (err error) {
	ch := make(chan error, 1)
	defer close(ch)
	callback := newFabricAsyncOperationCallback(func(sfctx *comIFabricAsyncOperationContext) {

		err := v.endUndoProgress(sfctx)

		if err != nil {
			ch <- err
			return
		}
		if err != nil {
			ch <- err
			return
		}
		ch <- nil
	})

	var timeout time.Duration
	{
		deadline, ok := ctx.Deadline()
		if ok {
			timeout = deadline.Sub(time.Now())
		} else {
			timeout = 15 * time.Minute
		}

		_ = timeout
	}
	sfctx, err := v.beginUndoProgress(
		fromCommitSequenceNumber,
		callback,
	)

	if err != nil {
		return
	}

	select {
	case err = <-ch:
		return

	case <-ctx.Done():
		sfctx.Cancel()
		err = ctx.Err()
		return
	case <-time.After(timeout):
		sfctx.Cancel()
		err = FabricErrorTimeout
		return
	}

}

func (c *FabricClient) CreateFabricServiceGroupFactory() (*ComFabricServiceGroupFactory, error) {
	var com *ComFabricServiceGroupFactory
	err := c.createComObject("{3860d61d-1e51-4a65-b109-d93c11311657}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricServiceGroupFactory struct {
	ole.IUnknown
}

type ComFabricServiceGroupFactoryVtbl struct {
	ole.IUnknownVtbl
}

func (v *ComFabricServiceGroupFactory) VTable() *ComFabricServiceGroupFactoryVtbl {
	return (*ComFabricServiceGroupFactoryVtbl)(unsafe.Pointer(v.RawVTable))
}

func (c *FabricClient) CreateFabricServiceGroupFactoryBuilder() (*ComFabricServiceGroupFactoryBuilder, error) {
	var com *ComFabricServiceGroupFactoryBuilder
	err := c.createComObject("{a9fe8b06-19b1-49e6-8911-41d9d9219e1c}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricServiceGroupFactoryBuilder struct {
	ole.IUnknown
}

type ComFabricServiceGroupFactoryBuilderVtbl struct {
	ole.IUnknownVtbl
	AddStatelessServiceFactory uintptr
	AddStatefulServiceFactory  uintptr
	RemoveServiceFactory       uintptr
	ToServiceGroupFactory      uintptr
}

func (v *ComFabricServiceGroupFactoryBuilder) VTable() *ComFabricServiceGroupFactoryBuilderVtbl {
	return (*ComFabricServiceGroupFactoryBuilderVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricServiceGroupFactoryBuilder) AddStatelessServiceFactory(
	memberServiceType string,
	factory *ComFabricStatelessServiceFactory,
) (err error) {
	var p_0 *uint16
	s_11, _ := windows.UTF16PtrFromString(memberServiceType)
	p_0 = s_11

	hr, _, err1 := syscall.Syscall(
		v.VTable().AddStatelessServiceFactory,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(factory)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricServiceGroupFactoryBuilder) AddStatefulServiceFactory(
	memberServiceType string,
	factory *ComFabricStatefulServiceFactory,
) (err error) {
	var p_0 *uint16
	s_12, _ := windows.UTF16PtrFromString(memberServiceType)
	p_0 = s_12

	hr, _, err1 := syscall.Syscall(
		v.VTable().AddStatefulServiceFactory,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(factory)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricServiceGroupFactoryBuilder) RemoveServiceFactory(
	memberServiceType string,
) (err error) {
	var p_0 *uint16
	s_13, _ := windows.UTF16PtrFromString(memberServiceType)
	p_0 = s_13

	hr, _, err1 := syscall.Syscall(
		v.VTable().RemoveServiceFactory,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricServiceGroupFactoryBuilder) ToServiceGroupFactory() (factory *ComFabricServiceGroupFactory, err error) {
	var p_0 *ComFabricServiceGroupFactory
	defer func() {
		factory = p_0
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().ToServiceGroupFactory,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(&p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricServiceGroupPartition() (*ComFabricServiceGroupPartition, error) {
	var com *ComFabricServiceGroupPartition
	err := c.createComObject("{2b24299a-7489-467f-8e7f-4507bff73b86}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricServiceGroupPartition struct {
	ole.IUnknown
}

type ComFabricServiceGroupPartitionVtbl struct {
	ole.IUnknownVtbl
	ResolveMember uintptr
}

func (v *ComFabricServiceGroupPartition) VTable() *ComFabricServiceGroupPartitionVtbl {
	return (*ComFabricServiceGroupPartitionVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricServiceGroupPartition) ResolveMember(
	name string,
	riid windows.GUID,
) (member interface{}, err error) {
	var p_0 *uint16
	s_14, _ := windows.UTF16PtrFromString(name)
	p_0 = s_14

	var p_2 unsafe.Pointer
	defer func() {
		member = fromUnsafePointer(p_2)
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().ResolveMember,
		4,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(&riid)),
		uintptr(unsafe.Pointer(&p_2)),
		0,
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricCodePackageActivationContext() (*ComFabricCodePackageActivationContext, error) {
	var com *ComFabricCodePackageActivationContext
	err := c.createComObject("{68a971e2-f15f-4d95-a79c-8a257909659e}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricCodePackageActivationContext struct {
	ole.IUnknown
}

type ComFabricCodePackageActivationContextVtbl struct {
	ole.IUnknownVtbl
	get_ContextId                               uintptr
	get_CodePackageName                         uintptr
	get_CodePackageVersion                      uintptr
	get_WorkDirectory                           uintptr
	get_LogDirectory                            uintptr
	get_TempDirectory                           uintptr
	get_ServiceTypes                            uintptr
	get_ServiceGroupTypes                       uintptr
	get_ApplicationPrincipals                   uintptr
	get_ServiceEndpointResources                uintptr
	GetServiceEndpointResource                  uintptr
	GetCodePackageNames                         uintptr
	GetConfigurationPackageNames                uintptr
	GetDataPackageNames                         uintptr
	GetCodePackage                              uintptr
	GetConfigurationPackage                     uintptr
	GetDataPackage                              uintptr
	RegisterCodePackageChangeHandler            uintptr
	UnregisterCodePackageChangeHandler          uintptr
	RegisterConfigurationPackageChangeHandler   uintptr
	UnregisterConfigurationPackageChangeHandler uintptr
	RegisterDataPackageChangeHandler            uintptr
	UnregisterDataPackageChangeHandler          uintptr
}

func (v *ComFabricCodePackageActivationContext) VTable() *ComFabricCodePackageActivationContextVtbl {
	return (*ComFabricCodePackageActivationContextVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricCodePackageActivationContext) GetContextId() (rt string, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_ContextId,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*uint16)(unsafe.Pointer(hr))

	rt = windows.UTF16PtrToString(tmp)
	return
}
func (v *ComFabricCodePackageActivationContext) GetCodePackageName() (rt string, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_CodePackageName,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*uint16)(unsafe.Pointer(hr))

	rt = windows.UTF16PtrToString(tmp)
	return
}
func (v *ComFabricCodePackageActivationContext) GetCodePackageVersion() (rt string, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_CodePackageVersion,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*uint16)(unsafe.Pointer(hr))

	rt = windows.UTF16PtrToString(tmp)
	return
}
func (v *ComFabricCodePackageActivationContext) GetWorkDirectory() (rt string, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_WorkDirectory,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*uint16)(unsafe.Pointer(hr))

	rt = windows.UTF16PtrToString(tmp)
	return
}
func (v *ComFabricCodePackageActivationContext) GetLogDirectory() (rt string, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_LogDirectory,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*uint16)(unsafe.Pointer(hr))

	rt = windows.UTF16PtrToString(tmp)
	return
}
func (v *ComFabricCodePackageActivationContext) GetTempDirectory() (rt string, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_TempDirectory,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*uint16)(unsafe.Pointer(hr))

	rt = windows.UTF16PtrToString(tmp)
	return
}
func (v *ComFabricCodePackageActivationContext) GetServiceTypes() (rt []FabricServiceTypeDescription, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_ServiceTypes,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*innerFabricServiceTypeDescriptionList)(unsafe.Pointer(hr))

	{
		var lst []FabricServiceTypeDescription

		var innerlst []innerFabricServiceTypeDescription

		{
			srclst := tmp
			slice := (*reflect.SliceHeader)(unsafe.Pointer(&innerlst))
			slice.Data = uintptr(unsafe.Pointer(srclst.Items))
			slice.Len = int(srclst.Count)
			slice.Cap = int(srclst.Count)
		}

		for _, item := range innerlst {
			var tmpitem FabricServiceTypeDescription

			tmpitem = *item.toGoStruct()

			lst = append(lst, tmpitem)
		}

		rt = lst
	}
	return
}
func (v *ComFabricCodePackageActivationContext) GetServiceGroupTypes() (rt []FabricServiceGroupTypeDescription, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_ServiceGroupTypes,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*innerFabricServiceGroupTypeDescriptionList)(unsafe.Pointer(hr))

	{
		var lst []FabricServiceGroupTypeDescription

		var innerlst []innerFabricServiceGroupTypeDescription

		{
			srclst := tmp
			slice := (*reflect.SliceHeader)(unsafe.Pointer(&innerlst))
			slice.Data = uintptr(unsafe.Pointer(srclst.Items))
			slice.Len = int(srclst.Count)
			slice.Cap = int(srclst.Count)
		}

		for _, item := range innerlst {
			var tmpitem FabricServiceGroupTypeDescription

			tmpitem = *item.toGoStruct()

			lst = append(lst, tmpitem)
		}

		rt = lst
	}
	return
}
func (v *ComFabricCodePackageActivationContext) GetApplicationPrincipals() (rt *FabricApplicationPrincipalsDescription, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_ApplicationPrincipals,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*innerFabricApplicationPrincipalsDescription)(unsafe.Pointer(hr))

	rt = tmp.toGoStruct()
	return
}
func (v *ComFabricCodePackageActivationContext) GetServiceEndpointResources() (rt []FabricEndpointResourceDescription, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_ServiceEndpointResources,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*innerFabricEndpointResourceDescriptionList)(unsafe.Pointer(hr))

	{
		var lst []FabricEndpointResourceDescription

		var innerlst []innerFabricEndpointResourceDescription

		{
			srclst := tmp
			slice := (*reflect.SliceHeader)(unsafe.Pointer(&innerlst))
			slice.Data = uintptr(unsafe.Pointer(srclst.Items))
			slice.Len = int(srclst.Count)
			slice.Cap = int(srclst.Count)
		}

		for _, item := range innerlst {
			var tmpitem FabricEndpointResourceDescription

			tmpitem = *item.toGoStruct()

			lst = append(lst, tmpitem)
		}

		rt = lst
	}
	return
}
func (v *ComFabricCodePackageActivationContext) GetServiceEndpointResource(
	serviceEndpointResourceName string,
) (bufferedValue *FabricEndpointResourceDescription, err error) {
	var p_0 *uint16
	s_18, _ := windows.UTF16PtrFromString(serviceEndpointResourceName)
	p_0 = s_18

	var p_1 *innerFabricEndpointResourceDescription
	defer func() {
		bufferedValue = p_1.toGoStruct()
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().GetServiceEndpointResource,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricCodePackageActivationContext) GetCodePackageNames() (names *ComFabricStringListResult, err error) {
	var p_0 *ComFabricStringListResult
	defer func() {
		names = p_0
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().GetCodePackageNames,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(&p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricCodePackageActivationContext) GetConfigurationPackageNames() (names *ComFabricStringListResult, err error) {
	var p_0 *ComFabricStringListResult
	defer func() {
		names = p_0
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().GetConfigurationPackageNames,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(&p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricCodePackageActivationContext) GetDataPackageNames() (names *ComFabricStringListResult, err error) {
	var p_0 *ComFabricStringListResult
	defer func() {
		names = p_0
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().GetDataPackageNames,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(&p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricCodePackageActivationContext) GetCodePackage(
	codePackageName string,
) (codePackage *ComFabricCodePackage, err error) {
	var p_0 *uint16
	s_19, _ := windows.UTF16PtrFromString(codePackageName)
	p_0 = s_19

	var p_1 *ComFabricCodePackage
	defer func() {
		codePackage = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().GetCodePackage,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricCodePackageActivationContext) GetConfigurationPackage(
	configPackageName string,
) (configPackage *ComFabricConfigurationPackage, err error) {
	var p_0 *uint16
	s_20, _ := windows.UTF16PtrFromString(configPackageName)
	p_0 = s_20

	var p_1 *ComFabricConfigurationPackage
	defer func() {
		configPackage = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().GetConfigurationPackage,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricCodePackageActivationContext) GetDataPackage(
	dataPackageName string,
) (dataPackage *ComFabricDataPackage, err error) {
	var p_0 *uint16
	s_21, _ := windows.UTF16PtrFromString(dataPackageName)
	p_0 = s_21

	var p_1 *ComFabricDataPackage
	defer func() {
		dataPackage = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().GetDataPackage,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricCodePackageActivationContext) RegisterCodePackageChangeHandler(
	callback *ComFabricCodePackageChangeHandler,
) (callbackHandle int64, err error) {
	var p_1 int64
	defer func() {
		callbackHandle = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().RegisterCodePackageChangeHandler,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricCodePackageActivationContext) UnregisterCodePackageChangeHandler(
	callbackHandle int64,
) (err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().UnregisterCodePackageChangeHandler,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(callbackHandle),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricCodePackageActivationContext) RegisterConfigurationPackageChangeHandler(
	callback *ComFabricConfigurationPackageChangeHandler,
) (callbackHandle int64, err error) {
	var p_1 int64
	defer func() {
		callbackHandle = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().RegisterConfigurationPackageChangeHandler,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricCodePackageActivationContext) UnregisterConfigurationPackageChangeHandler(
	callbackHandle int64,
) (err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().UnregisterConfigurationPackageChangeHandler,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(callbackHandle),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricCodePackageActivationContext) RegisterDataPackageChangeHandler(
	callback *ComFabricDataPackageChangeHandler,
) (callbackHandle int64, err error) {
	var p_1 int64
	defer func() {
		callbackHandle = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().RegisterDataPackageChangeHandler,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricCodePackageActivationContext) UnregisterDataPackageChangeHandler(
	callbackHandle int64,
) (err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().UnregisterDataPackageChangeHandler,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(callbackHandle),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricCodePackageActivationContext2() (*ComFabricCodePackageActivationContext2, error) {
	var com *ComFabricCodePackageActivationContext2
	err := c.createComObject("{6c83d5c1-1954-4b80-9175-0d0e7c8715c9}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricCodePackageActivationContext2 struct {
	ComFabricCodePackageActivationContext
}

type ComFabricCodePackageActivationContext2Vtbl struct {
	ComFabricCodePackageActivationContextVtbl
	get_ApplicationName       uintptr
	get_ApplicationTypeName   uintptr
	GetServiceManifestName    uintptr
	GetServiceManifestVersion uintptr
}

func (v *ComFabricCodePackageActivationContext2) VTable() *ComFabricCodePackageActivationContext2Vtbl {
	return (*ComFabricCodePackageActivationContext2Vtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricCodePackageActivationContext2) GetApplicationName() (rt string, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_ApplicationName,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*uint16)(unsafe.Pointer(hr))

	rt = windows.UTF16PtrToString(tmp)
	return
}
func (v *ComFabricCodePackageActivationContext2) GetApplicationTypeName() (rt string, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_ApplicationTypeName,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*uint16)(unsafe.Pointer(hr))

	rt = windows.UTF16PtrToString(tmp)
	return
}
func (v *ComFabricCodePackageActivationContext2) GetServiceManifestName() (serviceManifestName *ComFabricStringResult, err error) {
	var p_0 *ComFabricStringResult
	defer func() {
		serviceManifestName = p_0
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().GetServiceManifestName,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(&p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricCodePackageActivationContext2) GetServiceManifestVersion() (serviceManifestVersion *ComFabricStringResult, err error) {
	var p_0 *ComFabricStringResult
	defer func() {
		serviceManifestVersion = p_0
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().GetServiceManifestVersion,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(&p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricCodePackageActivationContext3() (*ComFabricCodePackageActivationContext3, error) {
	var com *ComFabricCodePackageActivationContext3
	err := c.createComObject("{6efee900-f491-4b03-bc5b-3a70de103593}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricCodePackageActivationContext3 struct {
	ComFabricCodePackageActivationContext2
}

type ComFabricCodePackageActivationContext3Vtbl struct {
	ComFabricCodePackageActivationContext2Vtbl
	ReportApplicationHealth            uintptr
	ReportDeployedApplicationHealth    uintptr
	ReportDeployedServicePackageHealth uintptr
}

func (v *ComFabricCodePackageActivationContext3) VTable() *ComFabricCodePackageActivationContext3Vtbl {
	return (*ComFabricCodePackageActivationContext3Vtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricCodePackageActivationContext3) ReportApplicationHealth(
	healthInfo *FabricHealthInformation,
) (err error) {
	var p_0 *innerFabricHealthInformation
	p_0 = healthInfo.toInnerStruct()
	hr, _, err1 := syscall.Syscall(
		v.VTable().ReportApplicationHealth,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricCodePackageActivationContext3) ReportDeployedApplicationHealth(
	healthInfo *FabricHealthInformation,
) (err error) {
	var p_0 *innerFabricHealthInformation
	p_0 = healthInfo.toInnerStruct()
	hr, _, err1 := syscall.Syscall(
		v.VTable().ReportDeployedApplicationHealth,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricCodePackageActivationContext3) ReportDeployedServicePackageHealth(
	healthInfo *FabricHealthInformation,
) (err error) {
	var p_0 *innerFabricHealthInformation
	p_0 = healthInfo.toInnerStruct()
	hr, _, err1 := syscall.Syscall(
		v.VTable().ReportDeployedServicePackageHealth,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricCodePackageActivationContext4() (*ComFabricCodePackageActivationContext4, error) {
	var com *ComFabricCodePackageActivationContext4
	err := c.createComObject("{99efebb6-a7b4-4d45-b45e-f191a66eef03}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricCodePackageActivationContext4 struct {
	ComFabricCodePackageActivationContext3
}

type ComFabricCodePackageActivationContext4Vtbl struct {
	ComFabricCodePackageActivationContext3Vtbl
	ReportApplicationHealth2            uintptr
	ReportDeployedApplicationHealth2    uintptr
	ReportDeployedServicePackageHealth2 uintptr
}

func (v *ComFabricCodePackageActivationContext4) VTable() *ComFabricCodePackageActivationContext4Vtbl {
	return (*ComFabricCodePackageActivationContext4Vtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricCodePackageActivationContext4) ReportApplicationHealth2(
	healthInfo *FabricHealthInformation,
	sendOptions *FabricHealthReportSendOptions,
) (err error) {
	var p_0 *innerFabricHealthInformation
	p_0 = healthInfo.toInnerStruct()
	var p_1 *innerFabricHealthReportSendOptions
	p_1 = sendOptions.toInnerStruct()
	hr, _, err1 := syscall.Syscall(
		v.VTable().ReportApplicationHealth2,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricCodePackageActivationContext4) ReportDeployedApplicationHealth2(
	healthInfo *FabricHealthInformation,
	sendOptions *FabricHealthReportSendOptions,
) (err error) {
	var p_0 *innerFabricHealthInformation
	p_0 = healthInfo.toInnerStruct()
	var p_1 *innerFabricHealthReportSendOptions
	p_1 = sendOptions.toInnerStruct()
	hr, _, err1 := syscall.Syscall(
		v.VTable().ReportDeployedApplicationHealth2,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricCodePackageActivationContext4) ReportDeployedServicePackageHealth2(
	healthInfo *FabricHealthInformation,
	sendOptions *FabricHealthReportSendOptions,
) (err error) {
	var p_0 *innerFabricHealthInformation
	p_0 = healthInfo.toInnerStruct()
	var p_1 *innerFabricHealthReportSendOptions
	p_1 = sendOptions.toInnerStruct()
	hr, _, err1 := syscall.Syscall(
		v.VTable().ReportDeployedServicePackageHealth2,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricCodePackageActivationContext5() (*ComFabricCodePackageActivationContext5, error) {
	var com *ComFabricCodePackageActivationContext5
	err := c.createComObject("{fe45387e-8711-4949-ac36-31dc95035513}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricCodePackageActivationContext5 struct {
	ComFabricCodePackageActivationContext4
}

type ComFabricCodePackageActivationContext5Vtbl struct {
	ComFabricCodePackageActivationContext4Vtbl
	get_ServiceListenAddress  uintptr
	get_ServicePublishAddress uintptr
}

func (v *ComFabricCodePackageActivationContext5) VTable() *ComFabricCodePackageActivationContext5Vtbl {
	return (*ComFabricCodePackageActivationContext5Vtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricCodePackageActivationContext5) GetServiceListenAddress() (rt string, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_ServiceListenAddress,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*uint16)(unsafe.Pointer(hr))

	rt = windows.UTF16PtrToString(tmp)
	return
}
func (v *ComFabricCodePackageActivationContext5) GetServicePublishAddress() (rt string, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_ServicePublishAddress,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*uint16)(unsafe.Pointer(hr))

	rt = windows.UTF16PtrToString(tmp)
	return
}

func (c *FabricClient) CreateFabricCodePackageActivationContext6() (*ComFabricCodePackageActivationContext6, error) {
	var com *ComFabricCodePackageActivationContext6
	err := c.createComObject("{fa5fda9b-472c-45a0-9b60-a374691227a4}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricCodePackageActivationContext6 struct {
	ComFabricCodePackageActivationContext5
}

type ComFabricCodePackageActivationContext6Vtbl struct {
	ComFabricCodePackageActivationContext5Vtbl
	GetDirectory uintptr
}

func (v *ComFabricCodePackageActivationContext6) VTable() *ComFabricCodePackageActivationContext6Vtbl {
	return (*ComFabricCodePackageActivationContext6Vtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricCodePackageActivationContext6) GetDirectory(
	logicalDirectoryName string,
) (directoryPath *ComFabricStringResult, err error) {
	var p_0 *uint16
	s_22, _ := windows.UTF16PtrFromString(logicalDirectoryName)
	p_0 = s_22

	var p_1 *ComFabricStringResult
	defer func() {
		directoryPath = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().GetDirectory,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricCodePackage() (*ComFabricCodePackage, error) {
	var com *ComFabricCodePackage
	err := c.createComObject("{20792b45-4d13-41a4-af13-346e529f00c5}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricCodePackage struct {
	ole.IUnknown
}

type ComFabricCodePackageVtbl struct {
	ole.IUnknownVtbl
	get_Description uintptr
	get_Path        uintptr
}

func (v *ComFabricCodePackage) VTable() *ComFabricCodePackageVtbl {
	return (*ComFabricCodePackageVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricCodePackage) GetDescription() (rt *FabricCodePackageDescription, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_Description,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*innerFabricCodePackageDescription)(unsafe.Pointer(hr))

	rt = tmp.toGoStruct()
	return
}
func (v *ComFabricCodePackage) GetPath() (rt string, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_Path,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*uint16)(unsafe.Pointer(hr))

	rt = windows.UTF16PtrToString(tmp)
	return
}

func (c *FabricClient) CreateFabricCodePackage2() (*ComFabricCodePackage2, error) {
	var com *ComFabricCodePackage2
	err := c.createComObject("{cdf0a4e6-ad80-4cd6-b67e-e4c002428600}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricCodePackage2 struct {
	ComFabricCodePackage
}

type ComFabricCodePackage2Vtbl struct {
	ComFabricCodePackageVtbl
	get_SetupEntryPointRunAsPolicy uintptr
	get_EntryPointRunAsPolicy      uintptr
}

func (v *ComFabricCodePackage2) VTable() *ComFabricCodePackage2Vtbl {
	return (*ComFabricCodePackage2Vtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricCodePackage2) GetSetupEntryPointRunAsPolicy() (rt *FabricRunasPolicyDescription, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_SetupEntryPointRunAsPolicy,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*innerFabricRunasPolicyDescription)(unsafe.Pointer(hr))

	rt = tmp.toGoStruct()
	return
}
func (v *ComFabricCodePackage2) GetEntryPointRunAsPolicy() (rt *FabricRunasPolicyDescription, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_EntryPointRunAsPolicy,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*innerFabricRunasPolicyDescription)(unsafe.Pointer(hr))

	rt = tmp.toGoStruct()
	return
}

func (c *FabricClient) CreateFabricConfigurationPackage() (*ComFabricConfigurationPackage, error) {
	var com *ComFabricConfigurationPackage
	err := c.createComObject("{ac4c3bfa-2563-46b7-a71d-2dca7b0a8f4d}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricConfigurationPackage struct {
	ole.IUnknown
}

type ComFabricConfigurationPackageVtbl struct {
	ole.IUnknownVtbl
	get_Description uintptr
	get_Path        uintptr
	get_Settings    uintptr
	GetSection      uintptr
	GetValue        uintptr
	DecryptValue    uintptr
}

func (v *ComFabricConfigurationPackage) VTable() *ComFabricConfigurationPackageVtbl {
	return (*ComFabricConfigurationPackageVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricConfigurationPackage) GetDescription() (rt *FabricConfigurationPackageDescription, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_Description,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*innerFabricConfigurationPackageDescription)(unsafe.Pointer(hr))

	rt = tmp.toGoStruct()
	return
}
func (v *ComFabricConfigurationPackage) GetPath() (rt string, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_Path,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*uint16)(unsafe.Pointer(hr))

	rt = windows.UTF16PtrToString(tmp)
	return
}
func (v *ComFabricConfigurationPackage) GetSettings() (rt *FabricConfigurationSettings, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_Settings,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*innerFabricConfigurationSettings)(unsafe.Pointer(hr))

	rt = tmp.toGoStruct()
	return
}
func (v *ComFabricConfigurationPackage) GetSection(
	sectionName string,
) (bufferedValue *FabricConfigurationSection, err error) {
	var p_0 *uint16
	s_23, _ := windows.UTF16PtrFromString(sectionName)
	p_0 = s_23

	var p_1 *innerFabricConfigurationSection
	defer func() {
		bufferedValue = p_1.toGoStruct()
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().GetSection,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricConfigurationPackage) GetValue(
	sectionName string,
	parameterName string,
) (isEncrypted bool, bufferedValue string, err error) {
	var p_0 *uint16
	s_24, _ := windows.UTF16PtrFromString(sectionName)
	p_0 = s_24

	var p_1 *uint16
	s_25, _ := windows.UTF16PtrFromString(parameterName)
	p_1 = s_25

	var p_2 bool
	defer func() {
		isEncrypted = p_2
	}()
	var p_3 *uint16
	defer func() {
		bufferedValue = windows.UTF16PtrToString(p_3)
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().GetValue,
		5,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(p_1)),
		uintptr(unsafe.Pointer(&p_2)),
		uintptr(unsafe.Pointer(&p_3)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricConfigurationPackage) DecryptValue(
	encryptedValue string,
) (decryptedValue *ComFabricStringResult, err error) {
	var p_0 *uint16
	s_26, _ := windows.UTF16PtrFromString(encryptedValue)
	p_0 = s_26

	var p_1 *ComFabricStringResult
	defer func() {
		decryptedValue = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().DecryptValue,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricConfigurationPackage2() (*ComFabricConfigurationPackage2, error) {
	var com *ComFabricConfigurationPackage2
	err := c.createComObject("{d3161f31-708a-4f83-91ff-f2af15f74a2f}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricConfigurationPackage2 struct {
	ComFabricConfigurationPackage
}

type ComFabricConfigurationPackage2Vtbl struct {
	ComFabricConfigurationPackageVtbl
	GetValues uintptr
}

func (v *ComFabricConfigurationPackage2) VTable() *ComFabricConfigurationPackage2Vtbl {
	return (*ComFabricConfigurationPackage2Vtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricConfigurationPackage2) GetValues(
	sectionName string,
	parameterPrefix string,
) (bufferedValue []FabricConfigurationParameter, err error) {
	var p_0 *uint16
	s_27, _ := windows.UTF16PtrFromString(sectionName)
	p_0 = s_27

	var p_1 *uint16
	s_28, _ := windows.UTF16PtrFromString(parameterPrefix)
	p_1 = s_28

	var p_2 *innerFabricConfigurationParameterList
	defer func() {
		{
			var lst []FabricConfigurationParameter

			var innerlst []innerFabricConfigurationParameter

			{
				srclst := p_2
				slice := (*reflect.SliceHeader)(unsafe.Pointer(&innerlst))
				slice.Data = uintptr(unsafe.Pointer(srclst.Items))
				slice.Len = int(srclst.Count)
				slice.Cap = int(srclst.Count)
			}

			for _, item := range innerlst {
				var tmpitem FabricConfigurationParameter

				tmpitem = *item.toGoStruct()

				lst = append(lst, tmpitem)
			}

			bufferedValue = lst
		}
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().GetValues,
		4,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(p_1)),
		uintptr(unsafe.Pointer(&p_2)),
		0,
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricDataPackage() (*ComFabricDataPackage, error) {
	var com *ComFabricDataPackage
	err := c.createComObject("{aa67de09-3657-435f-a2f6-b3a17a0a4371}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricDataPackage struct {
	ole.IUnknown
}

type ComFabricDataPackageVtbl struct {
	ole.IUnknownVtbl
	get_Description uintptr
	get_Path        uintptr
}

func (v *ComFabricDataPackage) VTable() *ComFabricDataPackageVtbl {
	return (*ComFabricDataPackageVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricDataPackage) GetDescription() (rt *FabricDataPackageDescription, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_Description,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*innerFabricDataPackageDescription)(unsafe.Pointer(hr))

	rt = tmp.toGoStruct()
	return
}
func (v *ComFabricDataPackage) GetPath() (rt string, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_Path,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*uint16)(unsafe.Pointer(hr))

	rt = windows.UTF16PtrToString(tmp)
	return
}

func (c *FabricClient) CreateFabricCodePackageChangeHandler() (*ComFabricCodePackageChangeHandler, error) {
	var com *ComFabricCodePackageChangeHandler
	err := c.createComObject("{b90d36cd-acb5-427a-b318-3b045981d0cc}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricCodePackageChangeHandler struct {
	ole.IUnknown
}

type ComFabricCodePackageChangeHandlerVtbl struct {
	ole.IUnknownVtbl
	OnPackageAdded    uintptr
	OnPackageRemoved  uintptr
	OnPackageModified uintptr
}

func (v *ComFabricCodePackageChangeHandler) VTable() *ComFabricCodePackageChangeHandlerVtbl {
	return (*ComFabricCodePackageChangeHandlerVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricCodePackageChangeHandler) OnPackageAdded(
	source *ComFabricCodePackageActivationContext,
	codePackage *ComFabricCodePackage,
) (rt interface{}, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().OnPackageAdded,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(source)),
		uintptr(unsafe.Pointer(codePackage)),
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (unsafe.Pointer)(unsafe.Pointer(hr))

	rt = fromUnsafePointer(tmp)
	return
}
func (v *ComFabricCodePackageChangeHandler) OnPackageRemoved(
	source *ComFabricCodePackageActivationContext,
	codePackage *ComFabricCodePackage,
) (rt interface{}, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().OnPackageRemoved,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(source)),
		uintptr(unsafe.Pointer(codePackage)),
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (unsafe.Pointer)(unsafe.Pointer(hr))

	rt = fromUnsafePointer(tmp)
	return
}
func (v *ComFabricCodePackageChangeHandler) OnPackageModified(
	source *ComFabricCodePackageActivationContext,
	previousCodePackage *ComFabricCodePackage,
	codePackage *ComFabricCodePackage,
) (rt interface{}, err error) {
	hr, _, err1 := syscall.Syscall6(
		v.VTable().OnPackageModified,
		4,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(source)),
		uintptr(unsafe.Pointer(previousCodePackage)),
		uintptr(unsafe.Pointer(codePackage)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (unsafe.Pointer)(unsafe.Pointer(hr))

	rt = fromUnsafePointer(tmp)
	return
}

func (c *FabricClient) CreateFabricConfigurationPackageChangeHandler() (*ComFabricConfigurationPackageChangeHandler, error) {
	var com *ComFabricConfigurationPackageChangeHandler
	err := c.createComObject("{c3954d48-b5ee-4ff4-9bc0-c30f6d0d3a85}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricConfigurationPackageChangeHandler struct {
	ole.IUnknown
}

type ComFabricConfigurationPackageChangeHandlerVtbl struct {
	ole.IUnknownVtbl
	OnPackageAdded    uintptr
	OnPackageRemoved  uintptr
	OnPackageModified uintptr
}

func (v *ComFabricConfigurationPackageChangeHandler) VTable() *ComFabricConfigurationPackageChangeHandlerVtbl {
	return (*ComFabricConfigurationPackageChangeHandlerVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricConfigurationPackageChangeHandler) OnPackageAdded(
	source *ComFabricCodePackageActivationContext,
	configPackage *ComFabricConfigurationPackage,
) (rt interface{}, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().OnPackageAdded,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(source)),
		uintptr(unsafe.Pointer(configPackage)),
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (unsafe.Pointer)(unsafe.Pointer(hr))

	rt = fromUnsafePointer(tmp)
	return
}
func (v *ComFabricConfigurationPackageChangeHandler) OnPackageRemoved(
	source *ComFabricCodePackageActivationContext,
	configPackage *ComFabricConfigurationPackage,
) (rt interface{}, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().OnPackageRemoved,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(source)),
		uintptr(unsafe.Pointer(configPackage)),
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (unsafe.Pointer)(unsafe.Pointer(hr))

	rt = fromUnsafePointer(tmp)
	return
}
func (v *ComFabricConfigurationPackageChangeHandler) OnPackageModified(
	source *ComFabricCodePackageActivationContext,
	previousConfigPackage *ComFabricConfigurationPackage,
	configPackage *ComFabricConfigurationPackage,
) (rt interface{}, err error) {
	hr, _, err1 := syscall.Syscall6(
		v.VTable().OnPackageModified,
		4,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(source)),
		uintptr(unsafe.Pointer(previousConfigPackage)),
		uintptr(unsafe.Pointer(configPackage)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (unsafe.Pointer)(unsafe.Pointer(hr))

	rt = fromUnsafePointer(tmp)
	return
}

func (c *FabricClient) CreateFabricDataPackageChangeHandler() (*ComFabricDataPackageChangeHandler, error) {
	var com *ComFabricDataPackageChangeHandler
	err := c.createComObject("{8d0a726f-bd17-4b32-807b-be2a8024b2e0}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricDataPackageChangeHandler struct {
	ole.IUnknown
}

type ComFabricDataPackageChangeHandlerVtbl struct {
	ole.IUnknownVtbl
	OnPackageAdded    uintptr
	OnPackageRemoved  uintptr
	OnPackageModified uintptr
}

func (v *ComFabricDataPackageChangeHandler) VTable() *ComFabricDataPackageChangeHandlerVtbl {
	return (*ComFabricDataPackageChangeHandlerVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricDataPackageChangeHandler) OnPackageAdded(
	source *ComFabricCodePackageActivationContext,
	dataPackage *ComFabricDataPackage,
) (rt interface{}, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().OnPackageAdded,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(source)),
		uintptr(unsafe.Pointer(dataPackage)),
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (unsafe.Pointer)(unsafe.Pointer(hr))

	rt = fromUnsafePointer(tmp)
	return
}
func (v *ComFabricDataPackageChangeHandler) OnPackageRemoved(
	source *ComFabricCodePackageActivationContext,
	dataPackage *ComFabricDataPackage,
) (rt interface{}, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().OnPackageRemoved,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(source)),
		uintptr(unsafe.Pointer(dataPackage)),
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (unsafe.Pointer)(unsafe.Pointer(hr))

	rt = fromUnsafePointer(tmp)
	return
}
func (v *ComFabricDataPackageChangeHandler) OnPackageModified(
	source *ComFabricCodePackageActivationContext,
	previousDataPackage *ComFabricDataPackage,
	dataPackage *ComFabricDataPackage,
) (rt interface{}, err error) {
	hr, _, err1 := syscall.Syscall6(
		v.VTable().OnPackageModified,
		4,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(source)),
		uintptr(unsafe.Pointer(previousDataPackage)),
		uintptr(unsafe.Pointer(dataPackage)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (unsafe.Pointer)(unsafe.Pointer(hr))

	rt = fromUnsafePointer(tmp)
	return
}

func (c *FabricClient) CreateFabricProcessExitHandler() (*ComFabricProcessExitHandler, error) {
	var com *ComFabricProcessExitHandler
	err := c.createComObject("{c58d50a2-01f0-4267-bbe7-223b565c1346}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricProcessExitHandler struct {
	ole.IUnknown
}

type ComFabricProcessExitHandlerVtbl struct {
	ole.IUnknownVtbl
	FabricProcessExited uintptr
}

func (v *ComFabricProcessExitHandler) VTable() *ComFabricProcessExitHandlerVtbl {
	return (*ComFabricProcessExitHandlerVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricProcessExitHandler) FabricProcessExited() (rt interface{}, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().FabricProcessExited,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (unsafe.Pointer)(unsafe.Pointer(hr))

	rt = fromUnsafePointer(tmp)
	return
}

func (c *FabricClient) CreateFabricTransactionBase() (*ComFabricTransactionBase, error) {
	var com *ComFabricTransactionBase
	err := c.createComObject("{32d656a1-7ad5-47b8-bd66-a2e302626b7e}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricTransactionBase struct {
	ole.IUnknown
}

type ComFabricTransactionBaseVtbl struct {
	ole.IUnknownVtbl
	get_Id             uintptr
	get_IsolationLevel uintptr
}

func (v *ComFabricTransactionBase) VTable() *ComFabricTransactionBaseVtbl {
	return (*ComFabricTransactionBaseVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricTransactionBase) GetId() (rt *windows.GUID, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_Id,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*windows.GUID)(unsafe.Pointer(hr))

	rt = tmp
	return
}
func (v *ComFabricTransactionBase) GetIsolationLevel() (rt FabricTransactionIsolationLevel, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_IsolationLevel,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	_ = err1
	rt = FabricTransactionIsolationLevel(hr)
	return
}

func (c *FabricClient) CreateFabricTransaction() (*ComFabricTransaction, error) {
	var com *ComFabricTransaction
	err := c.createComObject("{19ee48b4-6d4d-470b-ac1e-2d3996a173c8}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricTransaction struct {
	ComFabricTransactionBase
}

type ComFabricTransactionVtbl struct {
	ComFabricTransactionBaseVtbl
	BeginCommit uintptr
	EndCommit   uintptr
	Rollback    uintptr
}

func (v *ComFabricTransaction) VTable() *ComFabricTransactionVtbl {
	return (*ComFabricTransactionVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricTransaction) beginCommit(
	timeoutMilliseconds uint32,
	callback *comIFabricAsyncOperationCallback,
) (context *comIFabricAsyncOperationContext, err error) {
	var p_2 *comIFabricAsyncOperationContext
	defer func() {
		context = p_2
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().BeginCommit,
		4,
		uintptr(unsafe.Pointer(v)),
		uintptr(timeoutMilliseconds),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_2)),
		0,
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricTransaction) endCommit(
	context *comIFabricAsyncOperationContext,
) (commitSequenceNumber int64, err error) {
	var p_1 int64
	defer func() {
		commitSequenceNumber = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().EndCommit,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(context)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricTransaction) Rollback() (rt interface{}, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().Rollback,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (unsafe.Pointer)(unsafe.Pointer(hr))

	rt = fromUnsafePointer(tmp)
	return
}
func (v *ComFabricTransaction) Commit(
	ctx context.Context,
) (result_0 int64, err error) {
	ch := make(chan error, 1)
	defer close(ch)
	callback := newFabricAsyncOperationCallback(func(sfctx *comIFabricAsyncOperationContext) {

		rt_1, err := v.endCommit(sfctx)

		if err != nil {
			ch <- err
			return
		}
		if err != nil {
			ch <- err
			return
		}
		result_0 = rt_1
		ch <- nil
	})

	var timeout time.Duration
	{
		deadline, ok := ctx.Deadline()
		if ok {
			timeout = deadline.Sub(time.Now())
		} else {
			timeout = 15 * time.Minute
		}

		_ = timeout
	}
	sfctx, err := v.beginCommit(
		uint32(timeout.Milliseconds()),
		callback,
	)

	if err != nil {
		return
	}

	select {
	case err = <-ch:
		return

	case <-ctx.Done():
		sfctx.Cancel()
		err = ctx.Err()
		return
	case <-time.After(timeout):
		sfctx.Cancel()
		err = FabricErrorTimeout
		return
	}

}

func (c *FabricClient) CreateFabricKeyValueStoreReplica() (*ComFabricKeyValueStoreReplica, error) {
	var com *ComFabricKeyValueStoreReplica
	err := c.createComObject("{97da35c4-38ed-4a2a-8f37-fbeb56382235}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricKeyValueStoreReplica struct {
	ComFabricStatefulServiceReplica
}

type ComFabricKeyValueStoreReplicaVtbl struct {
	ComFabricStatefulServiceReplicaVtbl
	GetCurrentEpoch          uintptr
	UpdateReplicatorSettings uintptr
	CreateTransaction        uintptr
	Add                      uintptr
	Remove                   uintptr
	Update                   uintptr
	Get                      uintptr
	GetMetadata              uintptr
	Contains                 uintptr
	Enumerate                uintptr
	EnumerateByKey           uintptr
	EnumerateMetadata        uintptr
	EnumerateMetadataByKey   uintptr
}

func (v *ComFabricKeyValueStoreReplica) VTable() *ComFabricKeyValueStoreReplicaVtbl {
	return (*ComFabricKeyValueStoreReplicaVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricKeyValueStoreReplica) GetCurrentEpoch() (currentEpoch FabricEpoch, err error) {
	var p_0 innerFabricEpoch
	defer func() {
		currentEpoch = *p_0.toGoStruct()
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().GetCurrentEpoch,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(&p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricKeyValueStoreReplica) UpdateReplicatorSettings(
	replicatorSettings *FabricReplicatorSettings,
) (err error) {
	var p_0 *innerFabricReplicatorSettings
	p_0 = replicatorSettings.toInnerStruct()
	hr, _, err1 := syscall.Syscall(
		v.VTable().UpdateReplicatorSettings,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricKeyValueStoreReplica) CreateTransaction() (transaction *ComFabricTransaction, err error) {
	var p_0 *ComFabricTransaction
	defer func() {
		transaction = p_0
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().CreateTransaction,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(&p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricKeyValueStoreReplica) Add(
	transaction *ComFabricTransactionBase,
	key string,
	valueSizeInBytes int32,
	value *byte,
) (err error) {
	var p_1 *uint16
	s_30, _ := windows.UTF16PtrFromString(key)
	p_1 = s_30

	hr, _, err1 := syscall.Syscall6(
		v.VTable().Add,
		5,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(transaction)),
		uintptr(unsafe.Pointer(p_1)),
		uintptr(valueSizeInBytes),
		uintptr(unsafe.Pointer(value)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricKeyValueStoreReplica) Remove(
	transaction *ComFabricTransactionBase,
	key string,
	checkSequenceNumber int64,
) (err error) {
	var p_1 *uint16
	s_31, _ := windows.UTF16PtrFromString(key)
	p_1 = s_31

	hr, _, err1 := syscall.Syscall6(
		v.VTable().Remove,
		4,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(transaction)),
		uintptr(unsafe.Pointer(p_1)),
		uintptr(checkSequenceNumber),
		0,
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricKeyValueStoreReplica) Update(
	transaction *ComFabricTransactionBase,
	key string,
	valueSizeInBytes int32,
	value *byte,
	checkSequenceNumber int64,
) (err error) {
	var p_1 *uint16
	s_32, _ := windows.UTF16PtrFromString(key)
	p_1 = s_32

	hr, _, err1 := syscall.Syscall6(
		v.VTable().Update,
		6,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(transaction)),
		uintptr(unsafe.Pointer(p_1)),
		uintptr(valueSizeInBytes),
		uintptr(unsafe.Pointer(value)),
		uintptr(checkSequenceNumber),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricKeyValueStoreReplica) Get(
	transaction *ComFabricTransactionBase,
	key string,
) (result *ComFabricKeyValueStoreItemResult, err error) {
	var p_1 *uint16
	s_33, _ := windows.UTF16PtrFromString(key)
	p_1 = s_33

	var p_2 *ComFabricKeyValueStoreItemResult
	defer func() {
		result = p_2
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().Get,
		4,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(transaction)),
		uintptr(unsafe.Pointer(p_1)),
		uintptr(unsafe.Pointer(&p_2)),
		0,
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricKeyValueStoreReplica) GetMetadata(
	transaction *ComFabricTransactionBase,
	key string,
) (result *ComFabricKeyValueStoreItemMetadataResult, err error) {
	var p_1 *uint16
	s_34, _ := windows.UTF16PtrFromString(key)
	p_1 = s_34

	var p_2 *ComFabricKeyValueStoreItemMetadataResult
	defer func() {
		result = p_2
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().GetMetadata,
		4,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(transaction)),
		uintptr(unsafe.Pointer(p_1)),
		uintptr(unsafe.Pointer(&p_2)),
		0,
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricKeyValueStoreReplica) Contains(
	transaction *ComFabricTransactionBase,
	key string,
) (result bool, err error) {
	var p_1 *uint16
	s_35, _ := windows.UTF16PtrFromString(key)
	p_1 = s_35

	var p_2 bool
	defer func() {
		result = p_2
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().Contains,
		4,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(transaction)),
		uintptr(unsafe.Pointer(p_1)),
		uintptr(unsafe.Pointer(&p_2)),
		0,
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricKeyValueStoreReplica) Enumerate(
	transaction *ComFabricTransactionBase,
) (result *ComFabricKeyValueStoreItemEnumerator, err error) {
	var p_1 *ComFabricKeyValueStoreItemEnumerator
	defer func() {
		result = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().Enumerate,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(transaction)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricKeyValueStoreReplica) EnumerateByKey(
	transaction *ComFabricTransactionBase,
	keyPrefix string,
) (result *ComFabricKeyValueStoreItemEnumerator, err error) {
	var p_1 *uint16
	s_36, _ := windows.UTF16PtrFromString(keyPrefix)
	p_1 = s_36

	var p_2 *ComFabricKeyValueStoreItemEnumerator
	defer func() {
		result = p_2
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().EnumerateByKey,
		4,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(transaction)),
		uintptr(unsafe.Pointer(p_1)),
		uintptr(unsafe.Pointer(&p_2)),
		0,
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricKeyValueStoreReplica) EnumerateMetadata(
	transaction *ComFabricTransactionBase,
) (result *ComFabricKeyValueStoreItemMetadataEnumerator, err error) {
	var p_1 *ComFabricKeyValueStoreItemMetadataEnumerator
	defer func() {
		result = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().EnumerateMetadata,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(transaction)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricKeyValueStoreReplica) EnumerateMetadataByKey(
	transaction *ComFabricTransactionBase,
	keyPrefix string,
) (result *ComFabricKeyValueStoreItemMetadataEnumerator, err error) {
	var p_1 *uint16
	s_37, _ := windows.UTF16PtrFromString(keyPrefix)
	p_1 = s_37

	var p_2 *ComFabricKeyValueStoreItemMetadataEnumerator
	defer func() {
		result = p_2
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().EnumerateMetadataByKey,
		4,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(transaction)),
		uintptr(unsafe.Pointer(p_1)),
		uintptr(unsafe.Pointer(&p_2)),
		0,
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricKeyValueStoreReplica2() (*ComFabricKeyValueStoreReplica2, error) {
	var com *ComFabricKeyValueStoreReplica2
	err := c.createComObject("{fef805b2-5aca-4caa-9c51-fb3bd577a792}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricKeyValueStoreReplica2 struct {
	ComFabricKeyValueStoreReplica
}

type ComFabricKeyValueStoreReplica2Vtbl struct {
	ComFabricKeyValueStoreReplicaVtbl
	Backup             uintptr
	Restore            uintptr
	CreateTransaction2 uintptr
}

func (v *ComFabricKeyValueStoreReplica2) VTable() *ComFabricKeyValueStoreReplica2Vtbl {
	return (*ComFabricKeyValueStoreReplica2Vtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricKeyValueStoreReplica2) Backup(
	backupDirectory string,
) (err error) {
	var p_0 *uint16
	s_38, _ := windows.UTF16PtrFromString(backupDirectory)
	p_0 = s_38

	hr, _, err1 := syscall.Syscall(
		v.VTable().Backup,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricKeyValueStoreReplica2) Restore(
	backupDirectory string,
) (err error) {
	var p_0 *uint16
	s_39, _ := windows.UTF16PtrFromString(backupDirectory)
	p_0 = s_39

	hr, _, err1 := syscall.Syscall(
		v.VTable().Restore,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricKeyValueStoreReplica2) CreateTransaction2(
	settings *FabricKeyValueStoreTransactionSettings,
) (transaction *ComFabricTransaction, err error) {
	var p_0 *innerFabricKeyValueStoreTransactionSettings
	p_0 = settings.toInnerStruct()
	var p_1 *ComFabricTransaction
	defer func() {
		transaction = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().CreateTransaction2,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricKeyValueStoreReplica3() (*ComFabricKeyValueStoreReplica3, error) {
	var com *ComFabricKeyValueStoreReplica3
	err := c.createComObject("{c1297172-a8aa-4096-bdcc-1ece0c5d8c8f}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricKeyValueStoreReplica3 struct {
	ComFabricKeyValueStoreReplica2
}

type ComFabricKeyValueStoreReplica3Vtbl struct {
	ComFabricKeyValueStoreReplica2Vtbl
	BeginBackup uintptr
	EndBackup   uintptr
}

func (v *ComFabricKeyValueStoreReplica3) VTable() *ComFabricKeyValueStoreReplica3Vtbl {
	return (*ComFabricKeyValueStoreReplica3Vtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricKeyValueStoreReplica3) beginBackup(
	backupDirectory string,
	backupOption FabricStoreBackupOption,
	postBackupHandler *ComFabricStorePostBackupHandler,
	callback *comIFabricAsyncOperationCallback,
) (context *comIFabricAsyncOperationContext, err error) {
	var p_0 *uint16
	s_40, _ := windows.UTF16PtrFromString(backupDirectory)
	p_0 = s_40

	var p_4 *comIFabricAsyncOperationContext
	defer func() {
		context = p_4
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().BeginBackup,
		6,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(backupOption),
		uintptr(unsafe.Pointer(postBackupHandler)),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_4)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricKeyValueStoreReplica3) endBackup(
	context *comIFabricAsyncOperationContext,
) (err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().EndBackup,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(context)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricKeyValueStoreReplica3) Backup(
	ctx context.Context,
	backupDirectory string,
	backupOption FabricStoreBackupOption,
	postBackupHandler *ComFabricStorePostBackupHandler,
) (err error) {
	ch := make(chan error, 1)
	defer close(ch)
	callback := newFabricAsyncOperationCallback(func(sfctx *comIFabricAsyncOperationContext) {

		err := v.endBackup(sfctx)

		if err != nil {
			ch <- err
			return
		}
		if err != nil {
			ch <- err
			return
		}
		ch <- nil
	})

	var timeout time.Duration
	{
		deadline, ok := ctx.Deadline()
		if ok {
			timeout = deadline.Sub(time.Now())
		} else {
			timeout = 15 * time.Minute
		}

		_ = timeout
	}
	sfctx, err := v.beginBackup(
		backupDirectory,
		backupOption,
		postBackupHandler,
		callback,
	)

	if err != nil {
		return
	}

	select {
	case err = <-ch:
		return

	case <-ctx.Done():
		sfctx.Cancel()
		err = ctx.Err()
		return
	case <-time.After(timeout):
		sfctx.Cancel()
		err = FabricErrorTimeout
		return
	}

}

func (c *FabricClient) CreateFabricKeyValueStoreReplica4() (*ComFabricKeyValueStoreReplica4, error) {
	var com *ComFabricKeyValueStoreReplica4
	err := c.createComObject("{ff16d2f1-41a9-4c64-804a-a20bf28c04f3}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricKeyValueStoreReplica4 struct {
	ComFabricKeyValueStoreReplica3
}

type ComFabricKeyValueStoreReplica4Vtbl struct {
	ComFabricKeyValueStoreReplica3Vtbl
	BeginRestore uintptr
	EndRestore   uintptr
}

func (v *ComFabricKeyValueStoreReplica4) VTable() *ComFabricKeyValueStoreReplica4Vtbl {
	return (*ComFabricKeyValueStoreReplica4Vtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricKeyValueStoreReplica4) beginRestore(
	backupDirectory string,
	callback *comIFabricAsyncOperationCallback,
) (context *comIFabricAsyncOperationContext, err error) {
	var p_0 *uint16
	s_41, _ := windows.UTF16PtrFromString(backupDirectory)
	p_0 = s_41

	var p_2 *comIFabricAsyncOperationContext
	defer func() {
		context = p_2
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().BeginRestore,
		4,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_2)),
		0,
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricKeyValueStoreReplica4) endRestore(
	context *comIFabricAsyncOperationContext,
) (err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().EndRestore,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(context)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricKeyValueStoreReplica4) Restore(
	ctx context.Context,
	backupDirectory string,
) (err error) {
	ch := make(chan error, 1)
	defer close(ch)
	callback := newFabricAsyncOperationCallback(func(sfctx *comIFabricAsyncOperationContext) {

		err := v.endRestore(sfctx)

		if err != nil {
			ch <- err
			return
		}
		if err != nil {
			ch <- err
			return
		}
		ch <- nil
	})

	var timeout time.Duration
	{
		deadline, ok := ctx.Deadline()
		if ok {
			timeout = deadline.Sub(time.Now())
		} else {
			timeout = 15 * time.Minute
		}

		_ = timeout
	}
	sfctx, err := v.beginRestore(
		backupDirectory,
		callback,
	)

	if err != nil {
		return
	}

	select {
	case err = <-ch:
		return

	case <-ctx.Done():
		sfctx.Cancel()
		err = ctx.Err()
		return
	case <-time.After(timeout):
		sfctx.Cancel()
		err = FabricErrorTimeout
		return
	}

}

func (c *FabricClient) CreateFabricKeyValueStoreReplica5() (*ComFabricKeyValueStoreReplica5, error) {
	var com *ComFabricKeyValueStoreReplica5
	err := c.createComObject("{34f2da40-6227-448a-be72-c517b0d69432}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricKeyValueStoreReplica5 struct {
	ComFabricKeyValueStoreReplica4
}

type ComFabricKeyValueStoreReplica5Vtbl struct {
	ComFabricKeyValueStoreReplica4Vtbl
	TryAdd                  uintptr
	TryRemove               uintptr
	TryUpdate               uintptr
	TryGet                  uintptr
	TryGetMetadata          uintptr
	EnumerateByKey2         uintptr
	EnumerateMetadataByKey2 uintptr
}

func (v *ComFabricKeyValueStoreReplica5) VTable() *ComFabricKeyValueStoreReplica5Vtbl {
	return (*ComFabricKeyValueStoreReplica5Vtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricKeyValueStoreReplica5) TryAdd(
	transaction *ComFabricTransactionBase,
	key string,
	valueSizeInBytes int32,
	value *byte,
) (added bool, err error) {
	var p_1 *uint16
	s_42, _ := windows.UTF16PtrFromString(key)
	p_1 = s_42

	var p_4 bool
	defer func() {
		added = p_4
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().TryAdd,
		6,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(transaction)),
		uintptr(unsafe.Pointer(p_1)),
		uintptr(valueSizeInBytes),
		uintptr(unsafe.Pointer(value)),
		uintptr(unsafe.Pointer(&p_4)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricKeyValueStoreReplica5) TryRemove(
	transaction *ComFabricTransactionBase,
	key string,
	checkSequenceNumber int64,
) (exists bool, err error) {
	var p_1 *uint16
	s_43, _ := windows.UTF16PtrFromString(key)
	p_1 = s_43

	var p_3 bool
	defer func() {
		exists = p_3
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().TryRemove,
		5,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(transaction)),
		uintptr(unsafe.Pointer(p_1)),
		uintptr(checkSequenceNumber),
		uintptr(unsafe.Pointer(&p_3)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricKeyValueStoreReplica5) TryUpdate(
	transaction *ComFabricTransactionBase,
	key string,
	valueSizeInBytes int32,
	value *byte,
	checkSequenceNumber int64,
) (exists bool, err error) {
	var p_1 *uint16
	s_44, _ := windows.UTF16PtrFromString(key)
	p_1 = s_44

	var p_5 bool
	defer func() {
		exists = p_5
	}()
	hr, _, err1 := syscall.Syscall9(
		v.VTable().TryUpdate,
		7,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(transaction)),
		uintptr(unsafe.Pointer(p_1)),
		uintptr(valueSizeInBytes),
		uintptr(unsafe.Pointer(value)),
		uintptr(checkSequenceNumber),
		uintptr(unsafe.Pointer(&p_5)),
		0,
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricKeyValueStoreReplica5) TryGet(
	transaction *ComFabricTransactionBase,
	key string,
) (result *ComFabricKeyValueStoreItemResult, err error) {
	var p_1 *uint16
	s_45, _ := windows.UTF16PtrFromString(key)
	p_1 = s_45

	var p_2 *ComFabricKeyValueStoreItemResult
	defer func() {
		result = p_2
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().TryGet,
		4,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(transaction)),
		uintptr(unsafe.Pointer(p_1)),
		uintptr(unsafe.Pointer(&p_2)),
		0,
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricKeyValueStoreReplica5) TryGetMetadata(
	transaction *ComFabricTransactionBase,
	key string,
) (result *ComFabricKeyValueStoreItemMetadataResult, err error) {
	var p_1 *uint16
	s_46, _ := windows.UTF16PtrFromString(key)
	p_1 = s_46

	var p_2 *ComFabricKeyValueStoreItemMetadataResult
	defer func() {
		result = p_2
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().TryGetMetadata,
		4,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(transaction)),
		uintptr(unsafe.Pointer(p_1)),
		uintptr(unsafe.Pointer(&p_2)),
		0,
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricKeyValueStoreReplica5) EnumerateByKey2(
	transaction *ComFabricTransactionBase,
	keyPrefix string,
	strictPrefix bool,
) (result *ComFabricKeyValueStoreItemEnumerator, err error) {
	var p_1 *uint16
	s_47, _ := windows.UTF16PtrFromString(keyPrefix)
	p_1 = s_47

	p_2 := 0
	if strictPrefix {
		p_2 = 1
	}
	var p_3 *ComFabricKeyValueStoreItemEnumerator
	defer func() {
		result = p_3
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().EnumerateByKey2,
		5,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(transaction)),
		uintptr(unsafe.Pointer(p_1)),
		uintptr(p_2),
		uintptr(unsafe.Pointer(&p_3)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricKeyValueStoreReplica5) EnumerateMetadataByKey2(
	transaction *ComFabricTransactionBase,
	keyPrefix string,
	strictPrefix bool,
) (result *ComFabricKeyValueStoreItemMetadataEnumerator, err error) {
	var p_1 *uint16
	s_48, _ := windows.UTF16PtrFromString(keyPrefix)
	p_1 = s_48

	p_2 := 0
	if strictPrefix {
		p_2 = 1
	}
	var p_3 *ComFabricKeyValueStoreItemMetadataEnumerator
	defer func() {
		result = p_3
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().EnumerateMetadataByKey2,
		5,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(transaction)),
		uintptr(unsafe.Pointer(p_1)),
		uintptr(p_2),
		uintptr(unsafe.Pointer(&p_3)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricKeyValueStoreReplica6() (*ComFabricKeyValueStoreReplica6, error) {
	var com *ComFabricKeyValueStoreReplica6
	err := c.createComObject("{56e77be1-e81f-4e42-8522-162c2d608184}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricKeyValueStoreReplica6 struct {
	ComFabricKeyValueStoreReplica5
}

type ComFabricKeyValueStoreReplica6Vtbl struct {
	ComFabricKeyValueStoreReplica5Vtbl
	BeginRestore2 uintptr
}

func (v *ComFabricKeyValueStoreReplica6) VTable() *ComFabricKeyValueStoreReplica6Vtbl {
	return (*ComFabricKeyValueStoreReplica6Vtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricKeyValueStoreReplica6) beginRestore2(
	backupDirectory string,
	settings *FabricKeyValueStoreRestoreSettings,
	callback *comIFabricAsyncOperationCallback,
) (context *comIFabricAsyncOperationContext, err error) {
	var p_0 *uint16
	s_49, _ := windows.UTF16PtrFromString(backupDirectory)
	p_0 = s_49

	var p_1 *innerFabricKeyValueStoreRestoreSettings
	p_1 = settings.toInnerStruct()
	var p_3 *comIFabricAsyncOperationContext
	defer func() {
		context = p_3
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().BeginRestore2,
		5,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(p_1)),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_3)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricKeyValueStoreEnumerator() (*ComFabricKeyValueStoreEnumerator, error) {
	var com *ComFabricKeyValueStoreEnumerator
	err := c.createComObject("{6722b848-15bb-4528-bf54-c7bbe27b6f9a}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricKeyValueStoreEnumerator struct {
	ole.IUnknown
}

type ComFabricKeyValueStoreEnumeratorVtbl struct {
	ole.IUnknownVtbl
	EnumerateByKey         uintptr
	EnumerateMetadataByKey uintptr
}

func (v *ComFabricKeyValueStoreEnumerator) VTable() *ComFabricKeyValueStoreEnumeratorVtbl {
	return (*ComFabricKeyValueStoreEnumeratorVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricKeyValueStoreEnumerator) EnumerateByKey(
	keyPrefix string,
) (result *ComFabricKeyValueStoreItemEnumerator, err error) {
	var p_0 *uint16
	s_50, _ := windows.UTF16PtrFromString(keyPrefix)
	p_0 = s_50

	var p_1 *ComFabricKeyValueStoreItemEnumerator
	defer func() {
		result = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().EnumerateByKey,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricKeyValueStoreEnumerator) EnumerateMetadataByKey(
	keyPrefix string,
) (result *ComFabricKeyValueStoreItemMetadataEnumerator, err error) {
	var p_0 *uint16
	s_51, _ := windows.UTF16PtrFromString(keyPrefix)
	p_0 = s_51

	var p_1 *ComFabricKeyValueStoreItemMetadataEnumerator
	defer func() {
		result = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().EnumerateMetadataByKey,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricKeyValueStoreEnumerator2() (*ComFabricKeyValueStoreEnumerator2, error) {
	var com *ComFabricKeyValueStoreEnumerator2
	err := c.createComObject("{63dfd264-4f2b-4be6-8234-1fa200165fe9}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricKeyValueStoreEnumerator2 struct {
	ComFabricKeyValueStoreEnumerator
}

type ComFabricKeyValueStoreEnumerator2Vtbl struct {
	ComFabricKeyValueStoreEnumeratorVtbl
	EnumerateByKey2         uintptr
	EnumerateMetadataByKey2 uintptr
}

func (v *ComFabricKeyValueStoreEnumerator2) VTable() *ComFabricKeyValueStoreEnumerator2Vtbl {
	return (*ComFabricKeyValueStoreEnumerator2Vtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricKeyValueStoreEnumerator2) EnumerateByKey2(
	keyPrefix string,
	strictPrefix bool,
) (result *ComFabricKeyValueStoreItemEnumerator, err error) {
	var p_0 *uint16
	s_52, _ := windows.UTF16PtrFromString(keyPrefix)
	p_0 = s_52

	p_1 := 0
	if strictPrefix {
		p_1 = 1
	}
	var p_2 *ComFabricKeyValueStoreItemEnumerator
	defer func() {
		result = p_2
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().EnumerateByKey2,
		4,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(p_1),
		uintptr(unsafe.Pointer(&p_2)),
		0,
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricKeyValueStoreEnumerator2) EnumerateMetadataByKey2(
	keyPrefix string,
	strictPrefix bool,
) (result *ComFabricKeyValueStoreItemMetadataEnumerator, err error) {
	var p_0 *uint16
	s_53, _ := windows.UTF16PtrFromString(keyPrefix)
	p_0 = s_53

	p_1 := 0
	if strictPrefix {
		p_1 = 1
	}
	var p_2 *ComFabricKeyValueStoreItemMetadataEnumerator
	defer func() {
		result = p_2
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().EnumerateMetadataByKey2,
		4,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(p_1),
		uintptr(unsafe.Pointer(&p_2)),
		0,
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricKeyValueStoreItemEnumerator() (*ComFabricKeyValueStoreItemEnumerator, error) {
	var com *ComFabricKeyValueStoreItemEnumerator
	err := c.createComObject("{c202788f-54d3-44a6-8f3c-b4bbfcdb95d2}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricKeyValueStoreItemEnumerator struct {
	ole.IUnknown
}

type ComFabricKeyValueStoreItemEnumeratorVtbl struct {
	ole.IUnknownVtbl
	MoveNext    uintptr
	get_Current uintptr
}

func (v *ComFabricKeyValueStoreItemEnumerator) VTable() *ComFabricKeyValueStoreItemEnumeratorVtbl {
	return (*ComFabricKeyValueStoreItemEnumeratorVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricKeyValueStoreItemEnumerator) MoveNext() (err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().MoveNext,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricKeyValueStoreItemEnumerator) GetCurrent() (rt *ComFabricKeyValueStoreItemResult, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_Current,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*ComFabricKeyValueStoreItemResult)(unsafe.Pointer(hr))

	rt = tmp
	return
}

func (c *FabricClient) CreateFabricKeyValueStoreItemMetadataEnumerator() (*ComFabricKeyValueStoreItemMetadataEnumerator, error) {
	var com *ComFabricKeyValueStoreItemMetadataEnumerator
	err := c.createComObject("{0bc06aee-fffa-4450-9099-116a5f0e0b53}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricKeyValueStoreItemMetadataEnumerator struct {
	ole.IUnknown
}

type ComFabricKeyValueStoreItemMetadataEnumeratorVtbl struct {
	ole.IUnknownVtbl
	MoveNext    uintptr
	get_Current uintptr
}

func (v *ComFabricKeyValueStoreItemMetadataEnumerator) VTable() *ComFabricKeyValueStoreItemMetadataEnumeratorVtbl {
	return (*ComFabricKeyValueStoreItemMetadataEnumeratorVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricKeyValueStoreItemMetadataEnumerator) MoveNext() (err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().MoveNext,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricKeyValueStoreItemMetadataEnumerator) GetCurrent() (rt *ComFabricKeyValueStoreItemMetadataResult, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_Current,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*ComFabricKeyValueStoreItemMetadataResult)(unsafe.Pointer(hr))

	rt = tmp
	return
}

func (c *FabricClient) CreateFabricKeyValueStoreNotificationEnumerator() (*ComFabricKeyValueStoreNotificationEnumerator, error) {
	var com *ComFabricKeyValueStoreNotificationEnumerator
	err := c.createComObject("{ef25bc08-be76-43c7-adad-20f01fba3399}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricKeyValueStoreNotificationEnumerator struct {
	ole.IUnknown
}

type ComFabricKeyValueStoreNotificationEnumeratorVtbl struct {
	ole.IUnknownVtbl
	MoveNext    uintptr
	get_Current uintptr
	Reset       uintptr
}

func (v *ComFabricKeyValueStoreNotificationEnumerator) VTable() *ComFabricKeyValueStoreNotificationEnumeratorVtbl {
	return (*ComFabricKeyValueStoreNotificationEnumeratorVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricKeyValueStoreNotificationEnumerator) MoveNext() (err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().MoveNext,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricKeyValueStoreNotificationEnumerator) GetCurrent() (rt *ComFabricKeyValueStoreNotification, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_Current,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*ComFabricKeyValueStoreNotification)(unsafe.Pointer(hr))

	rt = tmp
	return
}
func (v *ComFabricKeyValueStoreNotificationEnumerator) Reset() (rt interface{}, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().Reset,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (unsafe.Pointer)(unsafe.Pointer(hr))

	rt = fromUnsafePointer(tmp)
	return
}

func (c *FabricClient) CreateFabricKeyValueStoreItemEnumerator2() (*ComFabricKeyValueStoreItemEnumerator2, error) {
	var com *ComFabricKeyValueStoreItemEnumerator2
	err := c.createComObject("{da143bbc-81e1-48cd-afd7-b642bc5b9bfd}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricKeyValueStoreItemEnumerator2 struct {
	ComFabricKeyValueStoreItemEnumerator
}

type ComFabricKeyValueStoreItemEnumerator2Vtbl struct {
	ComFabricKeyValueStoreItemEnumeratorVtbl
	TryMoveNext uintptr
}

func (v *ComFabricKeyValueStoreItemEnumerator2) VTable() *ComFabricKeyValueStoreItemEnumerator2Vtbl {
	return (*ComFabricKeyValueStoreItemEnumerator2Vtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricKeyValueStoreItemEnumerator2) TryMoveNext() (success bool, err error) {
	var p_0 bool
	defer func() {
		success = p_0
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().TryMoveNext,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(&p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricKeyValueStoreItemMetadataEnumerator2() (*ComFabricKeyValueStoreItemMetadataEnumerator2, error) {
	var com *ComFabricKeyValueStoreItemMetadataEnumerator2
	err := c.createComObject("{8803d53e-dd73-40fc-a662-1bfe999419ea}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricKeyValueStoreItemMetadataEnumerator2 struct {
	ComFabricKeyValueStoreItemMetadataEnumerator
}

type ComFabricKeyValueStoreItemMetadataEnumerator2Vtbl struct {
	ComFabricKeyValueStoreItemMetadataEnumeratorVtbl
	TryMoveNext uintptr
}

func (v *ComFabricKeyValueStoreItemMetadataEnumerator2) VTable() *ComFabricKeyValueStoreItemMetadataEnumerator2Vtbl {
	return (*ComFabricKeyValueStoreItemMetadataEnumerator2Vtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricKeyValueStoreItemMetadataEnumerator2) TryMoveNext() (success bool, err error) {
	var p_0 bool
	defer func() {
		success = p_0
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().TryMoveNext,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(&p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricKeyValueStoreNotificationEnumerator2() (*ComFabricKeyValueStoreNotificationEnumerator2, error) {
	var com *ComFabricKeyValueStoreNotificationEnumerator2
	err := c.createComObject("{55eec7c6-ae81-407a-b84c-22771d314ac7}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricKeyValueStoreNotificationEnumerator2 struct {
	ComFabricKeyValueStoreNotificationEnumerator
}

type ComFabricKeyValueStoreNotificationEnumerator2Vtbl struct {
	ComFabricKeyValueStoreNotificationEnumeratorVtbl
	TryMoveNext uintptr
}

func (v *ComFabricKeyValueStoreNotificationEnumerator2) VTable() *ComFabricKeyValueStoreNotificationEnumerator2Vtbl {
	return (*ComFabricKeyValueStoreNotificationEnumerator2Vtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricKeyValueStoreNotificationEnumerator2) TryMoveNext() (success bool, err error) {
	var p_0 bool
	defer func() {
		success = p_0
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().TryMoveNext,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(&p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricKeyValueStoreItemResult() (*ComFabricKeyValueStoreItemResult, error) {
	var com *ComFabricKeyValueStoreItemResult
	err := c.createComObject("{c1f1c89d-b0b8-44dc-bc97-6c074c1a805e}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricKeyValueStoreItemResult struct {
	ole.IUnknown
}

type ComFabricKeyValueStoreItemResultVtbl struct {
	ole.IUnknownVtbl
	get_Item uintptr
}

func (v *ComFabricKeyValueStoreItemResult) VTable() *ComFabricKeyValueStoreItemResultVtbl {
	return (*ComFabricKeyValueStoreItemResultVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricKeyValueStoreItemResult) GetItem() (rt *FabricKeyValueStoreItem, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_Item,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*innerFabricKeyValueStoreItem)(unsafe.Pointer(hr))

	rt = tmp.toGoStruct()
	return
}

func (c *FabricClient) CreateFabricKeyValueStoreItemMetadataResult() (*ComFabricKeyValueStoreItemMetadataResult, error) {
	var com *ComFabricKeyValueStoreItemMetadataResult
	err := c.createComObject("{17c483a1-69e6-4bdc-a058-54fd4a1839fd}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricKeyValueStoreItemMetadataResult struct {
	ole.IUnknown
}

type ComFabricKeyValueStoreItemMetadataResultVtbl struct {
	ole.IUnknownVtbl
	get_Metadata uintptr
}

func (v *ComFabricKeyValueStoreItemMetadataResult) VTable() *ComFabricKeyValueStoreItemMetadataResultVtbl {
	return (*ComFabricKeyValueStoreItemMetadataResultVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricKeyValueStoreItemMetadataResult) GetMetadata() (rt *FabricKeyValueStoreItemMetadata, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_Metadata,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*innerFabricKeyValueStoreItemMetadata)(unsafe.Pointer(hr))

	rt = tmp.toGoStruct()
	return
}

func (c *FabricClient) CreateFabricKeyValueStoreNotification() (*ComFabricKeyValueStoreNotification, error) {
	var com *ComFabricKeyValueStoreNotification
	err := c.createComObject("{cb660aa6-c51e-4f05-9526-93982b550e8f}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricKeyValueStoreNotification struct {
	ComFabricKeyValueStoreItemResult
}

type ComFabricKeyValueStoreNotificationVtbl struct {
	ComFabricKeyValueStoreItemResultVtbl
	IsDelete uintptr
}

func (v *ComFabricKeyValueStoreNotification) VTable() *ComFabricKeyValueStoreNotificationVtbl {
	return (*ComFabricKeyValueStoreNotificationVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricKeyValueStoreNotification) IsDelete() (rt bool, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().IsDelete,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	_ = err1
	rt = hr != 0
	return
}

func (c *FabricClient) CreateFabricStoreEventHandler() (*ComFabricStoreEventHandler, error) {
	var com *ComFabricStoreEventHandler
	err := c.createComObject("{220e6da4-985b-4dee-8fe9-77521b838795}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricStoreEventHandler struct {
	ole.IUnknown
}

type ComFabricStoreEventHandlerVtbl struct {
	ole.IUnknownVtbl
	OnDataLoss uintptr
}

func (v *ComFabricStoreEventHandler) VTable() *ComFabricStoreEventHandlerVtbl {
	return (*ComFabricStoreEventHandlerVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricStoreEventHandler) OnDataLoss() (rt interface{}, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().OnDataLoss,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (unsafe.Pointer)(unsafe.Pointer(hr))

	rt = fromUnsafePointer(tmp)
	return
}

func (c *FabricClient) CreateFabricStoreEventHandler2() (*ComFabricStoreEventHandler2, error) {
	var com *ComFabricStoreEventHandler2
	err := c.createComObject("{CCE4523F-614B-4D6A-98A3-1E197C0213EA}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricStoreEventHandler2 struct {
	ComFabricStoreEventHandler
}

type ComFabricStoreEventHandler2Vtbl struct {
	ComFabricStoreEventHandlerVtbl
	BeginOnDataLoss uintptr
	EndOnDataLoss   uintptr
}

func (v *ComFabricStoreEventHandler2) VTable() *ComFabricStoreEventHandler2Vtbl {
	return (*ComFabricStoreEventHandler2Vtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricStoreEventHandler2) beginOnDataLoss(
	callback *comIFabricAsyncOperationCallback,
) (context *comIFabricAsyncOperationContext, err error) {
	var p_1 *comIFabricAsyncOperationContext
	defer func() {
		context = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().BeginOnDataLoss,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStoreEventHandler2) endOnDataLoss(
	context *comIFabricAsyncOperationContext,
) (isStateChanged bool, err error) {
	var p_1 bool
	defer func() {
		isStateChanged = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().EndOnDataLoss,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(context)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStoreEventHandler2) OnDataLoss(
	ctx context.Context,
) (result_0 bool, err error) {
	ch := make(chan error, 1)
	defer close(ch)
	callback := newFabricAsyncOperationCallback(func(sfctx *comIFabricAsyncOperationContext) {

		rt_1, err := v.endOnDataLoss(sfctx)

		if err != nil {
			ch <- err
			return
		}
		if err != nil {
			ch <- err
			return
		}
		result_0 = rt_1
		ch <- nil
	})

	var timeout time.Duration
	{
		deadline, ok := ctx.Deadline()
		if ok {
			timeout = deadline.Sub(time.Now())
		} else {
			timeout = 15 * time.Minute
		}

		_ = timeout
	}
	sfctx, err := v.beginOnDataLoss(
		callback,
	)

	if err != nil {
		return
	}

	select {
	case err = <-ch:
		return

	case <-ctx.Done():
		sfctx.Cancel()
		err = ctx.Err()
		return
	case <-time.After(timeout):
		sfctx.Cancel()
		err = FabricErrorTimeout
		return
	}

}

func (c *FabricClient) CreateFabricStorePostBackupHandler() (*ComFabricStorePostBackupHandler, error) {
	var com *ComFabricStorePostBackupHandler
	err := c.createComObject("{2af2e8a6-41df-4e32-9d2a-d73a711e652a}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricStorePostBackupHandler struct {
	ole.IUnknown
}

type ComFabricStorePostBackupHandlerVtbl struct {
	ole.IUnknownVtbl
	BeginPostBackup uintptr
	EndPostBackup   uintptr
}

func (v *ComFabricStorePostBackupHandler) VTable() *ComFabricStorePostBackupHandlerVtbl {
	return (*ComFabricStorePostBackupHandlerVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricStorePostBackupHandler) beginPostBackup(
	info *FabricStoreBackupInfo,
	callback *comIFabricAsyncOperationCallback,
) (context *comIFabricAsyncOperationContext, err error) {
	var p_0 *innerFabricStoreBackupInfo
	p_0 = info.toInnerStruct()
	var p_2 *comIFabricAsyncOperationContext
	defer func() {
		context = p_2
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().BeginPostBackup,
		4,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_2)),
		0,
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStorePostBackupHandler) endPostBackup(
	context *comIFabricAsyncOperationContext,
) (status bool, err error) {
	var p_1 bool
	defer func() {
		status = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().EndPostBackup,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(context)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricStorePostBackupHandler) PostBackup(
	ctx context.Context,
	info *FabricStoreBackupInfo,
) (result_0 bool, err error) {
	ch := make(chan error, 1)
	defer close(ch)
	callback := newFabricAsyncOperationCallback(func(sfctx *comIFabricAsyncOperationContext) {

		rt_1, err := v.endPostBackup(sfctx)

		if err != nil {
			ch <- err
			return
		}
		if err != nil {
			ch <- err
			return
		}
		result_0 = rt_1
		ch <- nil
	})

	var timeout time.Duration
	{
		deadline, ok := ctx.Deadline()
		if ok {
			timeout = deadline.Sub(time.Now())
		} else {
			timeout = 15 * time.Minute
		}

		_ = timeout
	}
	sfctx, err := v.beginPostBackup(
		info,
		callback,
	)

	if err != nil {
		return
	}

	select {
	case err = <-ch:
		return

	case <-ctx.Done():
		sfctx.Cancel()
		err = ctx.Err()
		return
	case <-time.After(timeout):
		sfctx.Cancel()
		err = FabricErrorTimeout
		return
	}

}

func (c *FabricClient) CreateFabricSecondaryEventHandler() (*ComFabricSecondaryEventHandler, error) {
	var com *ComFabricSecondaryEventHandler
	err := c.createComObject("{7d124a7d-258e-49f2-a9b0-e800406103fb}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricSecondaryEventHandler struct {
	ole.IUnknown
}

type ComFabricSecondaryEventHandlerVtbl struct {
	ole.IUnknownVtbl
	OnCopyComplete         uintptr
	OnReplicationOperation uintptr
}

func (v *ComFabricSecondaryEventHandler) VTable() *ComFabricSecondaryEventHandlerVtbl {
	return (*ComFabricSecondaryEventHandlerVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricSecondaryEventHandler) OnCopyComplete(
	enumerator *ComFabricKeyValueStoreEnumerator,
) (err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().OnCopyComplete,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(enumerator)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricSecondaryEventHandler) OnReplicationOperation(
	enumerator *ComFabricKeyValueStoreNotificationEnumerator,
) (err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().OnReplicationOperation,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(enumerator)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricNodeContextResult() (*ComFabricNodeContextResult, error) {
	var com *ComFabricNodeContextResult
	err := c.createComObject("{0952f885-6f5a-4ed3-abe4-90c403d1e3ce}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricNodeContextResult struct {
	ole.IUnknown
}

type ComFabricNodeContextResultVtbl struct {
	ole.IUnknownVtbl
	get_NodeContext uintptr
}

func (v *ComFabricNodeContextResult) VTable() *ComFabricNodeContextResultVtbl {
	return (*ComFabricNodeContextResultVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricNodeContextResult) GetNodeContext() (rt *FabricNodeContext, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_NodeContext,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*innerFabricNodeContext)(unsafe.Pointer(hr))

	rt = tmp.toGoStruct()
	return
}

func (c *FabricClient) CreateFabricNodeContextResult2() (*ComFabricNodeContextResult2, error) {
	var com *ComFabricNodeContextResult2
	err := c.createComObject("{472bf2e1-d617-4b5c-a91d-fabed9ff3550}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricNodeContextResult2 struct {
	ComFabricNodeContextResult
}

type ComFabricNodeContextResult2Vtbl struct {
	ComFabricNodeContextResultVtbl
	GetDirectory uintptr
}

func (v *ComFabricNodeContextResult2) VTable() *ComFabricNodeContextResult2Vtbl {
	return (*ComFabricNodeContextResult2Vtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricNodeContextResult2) GetDirectory(
	logicalDirectoryName string,
) (directoryPath *ComFabricStringResult, err error) {
	var p_0 *uint16
	s_54, _ := windows.UTF16PtrFromString(logicalDirectoryName)
	p_0 = s_54

	var p_1 *ComFabricStringResult
	defer func() {
		directoryPath = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().GetDirectory,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}

func (c *FabricClient) CreateFabricReplicatorSettingsResult() (*ComFabricReplicatorSettingsResult, error) {
	var com *ComFabricReplicatorSettingsResult
	err := c.createComObject("{718954F3-DC1E-4060-9806-0CBF36F71051}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricReplicatorSettingsResult struct {
	ole.IUnknown
}

type ComFabricReplicatorSettingsResultVtbl struct {
	ole.IUnknownVtbl
	get_ReplicatorSettings uintptr
}

func (v *ComFabricReplicatorSettingsResult) VTable() *ComFabricReplicatorSettingsResultVtbl {
	return (*ComFabricReplicatorSettingsResultVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricReplicatorSettingsResult) GetReplicatorSettings() (rt *FabricReplicatorSettings, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_ReplicatorSettings,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*innerFabricReplicatorSettings)(unsafe.Pointer(hr))

	rt = tmp.toGoStruct()
	return
}

func (c *FabricClient) CreateFabricEseLocalStoreSettingsResult() (*ComFabricEseLocalStoreSettingsResult, error) {
	var com *ComFabricEseLocalStoreSettingsResult
	err := c.createComObject("{AACE77AE-D8E1-4144-B1EE-5AC74FD54F65}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricEseLocalStoreSettingsResult struct {
	ole.IUnknown
}

type ComFabricEseLocalStoreSettingsResultVtbl struct {
	ole.IUnknownVtbl
	get_Settings uintptr
}

func (v *ComFabricEseLocalStoreSettingsResult) VTable() *ComFabricEseLocalStoreSettingsResultVtbl {
	return (*ComFabricEseLocalStoreSettingsResultVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricEseLocalStoreSettingsResult) GetSettings() (rt *FabricEseLocalStoreSettings, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_Settings,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*innerFabricEseLocalStoreSettings)(unsafe.Pointer(hr))

	rt = tmp.toGoStruct()
	return
}

func (c *FabricClient) CreateFabricSecurityCredentialsResult() (*ComFabricSecurityCredentialsResult, error) {
	var com *ComFabricSecurityCredentialsResult
	err := c.createComObject("{049A111D-6A30-48E9-8F69-470760D3EFB9}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricSecurityCredentialsResult struct {
	ole.IUnknown
}

type ComFabricSecurityCredentialsResultVtbl struct {
	ole.IUnknownVtbl
	get_SecurityCredentials uintptr
}

func (v *ComFabricSecurityCredentialsResult) VTable() *ComFabricSecurityCredentialsResultVtbl {
	return (*ComFabricSecurityCredentialsResultVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricSecurityCredentialsResult) GetSecurityCredentials() (rt *FabricSecurityCredentials, err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().get_SecurityCredentials,
		1,
		uintptr(unsafe.Pointer(v)),
		0,
		0,
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (*innerFabricSecurityCredentials)(unsafe.Pointer(hr))

	rt = tmp.toGoStruct()
	return
}

func (c *FabricClient) CreateFabricCodePackageActivator() (*ComFabricCodePackageActivator, error) {
	var com *ComFabricCodePackageActivator
	err := c.createComObject("{70BE1B10-B259-46FC-B813-0B75720E7183}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricCodePackageActivator struct {
	ole.IUnknown
}

type ComFabricCodePackageActivatorVtbl struct {
	ole.IUnknownVtbl
	BeginActivateCodePackage          uintptr
	EndActivateCodePackage            uintptr
	BeginDeactivateCodePackage        uintptr
	EndDeactivateCodePackage          uintptr
	AbortCodePackage                  uintptr
	RegisterCodePackageEventHandler   uintptr
	UnregisterCodePackageEventHandler uintptr
}

func (v *ComFabricCodePackageActivator) VTable() *ComFabricCodePackageActivatorVtbl {
	return (*ComFabricCodePackageActivatorVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricCodePackageActivator) beginActivateCodePackage(
	codePackageNames []string,
	environment map[string]string,
	timeoutMilliseconds uint32,
	callback *comIFabricAsyncOperationCallback,
) (context *comIFabricAsyncOperationContext, err error) {
	var p_0 *innerFabricStringList
	{
		lst := &innerFabricStringList{}

		var tmp []*uint16

		for _, item := range codePackageNames {
			var tmpitem *uint16

			s_56, _ := windows.UTF16PtrFromString(item)
			tmpitem = s_56

			tmp = append(tmp, tmpitem)
		}

		lst.Count = uint32(len(tmp))
		if len(tmp) > 0 {
			lst.Items = &tmp[0]
		}

		p_0 = lst
	}
	var p_1 *innerFabricStringMap
	{
		mapobj := &innerFabricStringMap{}

		var tmp []innerFabricApplicationParameter

		for k, v := range environment {
			kv := innerFabricApplicationParameter{}

			s_58, _ := windows.UTF16PtrFromString(k)
			kv.Name = s_58

			s_59, _ := windows.UTF16PtrFromString(v)
			kv.Value = s_59

			tmp = append(tmp, kv)
		}

		mapobj.Count = uint32(len(tmp))
		if len(tmp) > 0 {
			mapobj.Items = &tmp[0]
		}

		p_1 = mapobj
	}
	var p_4 *comIFabricAsyncOperationContext
	defer func() {
		context = p_4
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().BeginActivateCodePackage,
		6,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(unsafe.Pointer(p_1)),
		uintptr(timeoutMilliseconds),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_4)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricCodePackageActivator) endActivateCodePackage(
	context *comIFabricAsyncOperationContext,
) (err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().EndActivateCodePackage,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(context)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricCodePackageActivator) beginDeactivateCodePackage(
	codePackageNames []string,
	timeoutMilliseconds uint32,
	callback *comIFabricAsyncOperationCallback,
) (context *comIFabricAsyncOperationContext, err error) {
	var p_0 *innerFabricStringList
	{
		lst := &innerFabricStringList{}

		var tmp []*uint16

		for _, item := range codePackageNames {
			var tmpitem *uint16

			s_61, _ := windows.UTF16PtrFromString(item)
			tmpitem = s_61

			tmp = append(tmp, tmpitem)
		}

		lst.Count = uint32(len(tmp))
		if len(tmp) > 0 {
			lst.Items = &tmp[0]
		}

		p_0 = lst
	}
	var p_3 *comIFabricAsyncOperationContext
	defer func() {
		context = p_3
	}()
	hr, _, err1 := syscall.Syscall6(
		v.VTable().BeginDeactivateCodePackage,
		5,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		uintptr(timeoutMilliseconds),
		uintptr(unsafe.Pointer(callback)),
		uintptr(unsafe.Pointer(&p_3)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricCodePackageActivator) endDeactivateCodePackage(
	context *comIFabricAsyncOperationContext,
) (err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().EndDeactivateCodePackage,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(context)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricCodePackageActivator) AbortCodePackage(
	codePackageNames []string,
) (err error) {
	var p_0 *innerFabricStringList
	{
		lst := &innerFabricStringList{}

		var tmp []*uint16

		for _, item := range codePackageNames {
			var tmpitem *uint16

			s_63, _ := windows.UTF16PtrFromString(item)
			tmpitem = s_63

			tmp = append(tmp, tmpitem)
		}

		lst.Count = uint32(len(tmp))
		if len(tmp) > 0 {
			lst.Items = &tmp[0]
		}

		p_0 = lst
	}
	hr, _, err1 := syscall.Syscall(
		v.VTable().AbortCodePackage,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(p_0)),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricCodePackageActivator) RegisterCodePackageEventHandler(
	eventHandler *ComFabricCodePackageEventHandler,
) (callbackHandle uint64, err error) {
	var p_1 uint64
	defer func() {
		callbackHandle = p_1
	}()
	hr, _, err1 := syscall.Syscall(
		v.VTable().RegisterCodePackageEventHandler,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(eventHandler)),
		uintptr(unsafe.Pointer(&p_1)),
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricCodePackageActivator) UnregisterCodePackageEventHandler(
	callbackHandle uint64,
) (err error) {
	hr, _, err1 := syscall.Syscall(
		v.VTable().UnregisterCodePackageEventHandler,
		2,
		uintptr(unsafe.Pointer(v)),
		uintptr(callbackHandle),
		0,
	)
	if hr != 0 {
		err = errno(hr, err1)
		return
	}
	return
}
func (v *ComFabricCodePackageActivator) ActivateCodePackage(
	ctx context.Context,
	codePackageNames []string,
	environment map[string]string,
) (err error) {
	ch := make(chan error, 1)
	defer close(ch)
	callback := newFabricAsyncOperationCallback(func(sfctx *comIFabricAsyncOperationContext) {

		err := v.endActivateCodePackage(sfctx)

		if err != nil {
			ch <- err
			return
		}
		if err != nil {
			ch <- err
			return
		}
		ch <- nil
	})

	var timeout time.Duration
	{
		deadline, ok := ctx.Deadline()
		if ok {
			timeout = deadline.Sub(time.Now())
		} else {
			timeout = 15 * time.Minute
		}

		_ = timeout
	}
	sfctx, err := v.beginActivateCodePackage(
		codePackageNames,
		environment,
		uint32(timeout.Milliseconds()),
		callback,
	)

	if err != nil {
		return
	}

	select {
	case err = <-ch:
		return

	case <-ctx.Done():
		sfctx.Cancel()
		err = ctx.Err()
		return
	case <-time.After(timeout):
		sfctx.Cancel()
		err = FabricErrorTimeout
		return
	}

}
func (v *ComFabricCodePackageActivator) DeactivateCodePackage(
	ctx context.Context,
	codePackageNames []string,
) (err error) {
	ch := make(chan error, 1)
	defer close(ch)
	callback := newFabricAsyncOperationCallback(func(sfctx *comIFabricAsyncOperationContext) {

		err := v.endDeactivateCodePackage(sfctx)

		if err != nil {
			ch <- err
			return
		}
		if err != nil {
			ch <- err
			return
		}
		ch <- nil
	})

	var timeout time.Duration
	{
		deadline, ok := ctx.Deadline()
		if ok {
			timeout = deadline.Sub(time.Now())
		} else {
			timeout = 15 * time.Minute
		}

		_ = timeout
	}
	sfctx, err := v.beginDeactivateCodePackage(
		codePackageNames,
		uint32(timeout.Milliseconds()),
		callback,
	)

	if err != nil {
		return
	}

	select {
	case err = <-ch:
		return

	case <-ctx.Done():
		sfctx.Cancel()
		err = ctx.Err()
		return
	case <-time.After(timeout):
		sfctx.Cancel()
		err = FabricErrorTimeout
		return
	}

}

func (c *FabricClient) CreateFabricCodePackageEventHandler() (*ComFabricCodePackageEventHandler, error) {
	var com *ComFabricCodePackageEventHandler
	err := c.createComObject("{899E0CA8-16DF-458E-8915-D0307B4AB101}", unsafe.Pointer(&com))
	if err != nil {
		return nil, err
	}

	return com, nil
}

type ComFabricCodePackageEventHandler struct {
	ole.IUnknown
}

type ComFabricCodePackageEventHandlerVtbl struct {
	ole.IUnknownVtbl
	OnCodePackageEvent uintptr
}

func (v *ComFabricCodePackageEventHandler) VTable() *ComFabricCodePackageEventHandlerVtbl {
	return (*ComFabricCodePackageEventHandlerVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *ComFabricCodePackageEventHandler) OnCodePackageEvent(
	source *ComFabricCodePackageActivator,
	eventDesc *FabricCodePackageEventDescription,
) (rt interface{}, err error) {
	var p_1 *innerFabricCodePackageEventDescription
	p_1 = eventDesc.toInnerStruct()
	hr, _, err1 := syscall.Syscall(
		v.VTable().OnCodePackageEvent,
		3,
		uintptr(unsafe.Pointer(v)),
		uintptr(unsafe.Pointer(source)),
		uintptr(unsafe.Pointer(p_1)),
	)
	if hr == 0 {
		err = err1
		return
	}

	tmp := (unsafe.Pointer)(unsafe.Pointer(hr))

	rt = fromUnsafePointer(tmp)
	return
}
